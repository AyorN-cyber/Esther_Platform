import{s as o}from"./index-B2nncEd6.js";import"./react-vendor-BkZfVlwG.js";import"./icons-BMGuJ0FM.js";var h=Object.defineProperty,m=Object.defineProperties,y=Object.getOwnPropertyDescriptors,v=Object.getOwnPropertySymbols,w=Object.prototype.hasOwnProperty,b=Object.prototype.propertyIsEnumerable,p=(r,e,t)=>e in r?h(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,l=(r,e)=>{for(var t in e||(e={}))w.call(e,t)&&p(r,t,e[t]);if(v)for(var t of v(e))b.call(e,t)&&p(r,t,e[t]);return r},u=(r,e)=>m(r,y(e)),n=(r,e,t)=>new Promise((s,c)=>{var g=i=>{try{d(t.next(i))}catch(a){c(a)}},_=i=>{try{d(t.throw(i))}catch(a){c(a)}},d=i=>i.done?s(i.value):Promise.resolve(i.value).then(g,_);d((t=t.apply(r,e)).next())});const O=()=>n(void 0,null,function*(){try{const{data:r,error:e}=yield o.from("videos").select("*").order("order_index",{ascending:!0});if(e)throw e;return r||[]}catch(r){return console.error("Error fetching videos:",r),[]}}),V=()=>n(void 0,null,function*(){try{const{data:r,error:e}=yield o.from("videos").select("*").eq("status","completed").order("order_index",{ascending:!0});if(e)throw e;return r||[]}catch(r){return console.error("Error fetching completed videos:",r),[]}}),D=r=>n(void 0,null,function*(){try{const e=u(l({id:"video_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))},r),{created_at:new Date().toISOString(),updated_at:new Date().toISOString()}),{data:t,error:s}=yield o.from("videos").insert([e]).select().single();if(s)throw s;return t}catch(e){return console.error("Error adding video:",e),null}}),I=(r,e)=>n(void 0,null,function*(){try{const{error:t}=yield o.from("videos").update(u(l({},e),{updated_at:new Date().toISOString()})).eq("id",r);if(t)throw t;return!0}catch(t){return console.error("Error updating video:",t),!1}}),q=r=>n(void 0,null,function*(){try{const{error:e}=yield o.from("videos").delete().eq("id",r);if(e)throw e;return!0}catch(e){return console.error("Error deleting video:",e),!1}}),j=r=>n(void 0,null,function*(){try{const e=r.map((s,c)=>({id:s.id,order_index:c,updated_at:new Date().toISOString()})),{error:t}=yield o.from("videos").upsert(e);if(t)throw t;return!0}catch(e){return console.error("Error reordering videos:",e),!1}}),f=()=>n(void 0,null,function*(){try{const{data:r,error:e}=yield o.from("site_settings").select("*").eq("id","main").single();if(e)throw e;return r}catch(r){return console.error("Error fetching settings:",r),null}}),x=r=>n(void 0,null,function*(){try{const{error:e}=yield o.from("site_settings").update(u(l({},r),{updated_at:new Date().toISOString()})).eq("id","main");if(e)throw e;return!0}catch(e){return console.error("Error updating settings:",e),!1}}),C=()=>n(void 0,null,function*(){try{const r=yield f(),e=(r==null?void 0:r.total_visits)||0;yield o.from("site_settings").update({total_visits:e+1,updated_at:new Date().toISOString()}).eq("id","main")}catch(r){console.error("Error tracking visit:",r)}}),T=r=>{const e=o.channel("videos_changes").on("postgres_changes",{event:"*",schema:"public",table:"videos"},()=>n(void 0,null,function*(){const t=yield O();r(t)})).subscribe();return()=>{o.removeChannel(e)}},$=r=>{const e=o.channel("settings_changes").on("postgres_changes",{event:"*",schema:"public",table:"site_settings"},()=>n(void 0,null,function*(){const t=yield f();r(t)})).subscribe();return()=>{o.removeChannel(e)}};export{D as addVideo,q as deleteVideo,V as getCompletedVideos,f as getSettings,O as getVideos,j as reorderVideos,$ as subscribeToSettings,T as subscribeToVideos,C as trackVisit,x as updateSettings,I as updateVideo};
