System.register(["./index-legacy-Cb6hA_pB.js","./react-vendor-legacy-CC-5X576.js","./icons-legacy-BwBbydQ_.js"],function(e,r){"use strict";var t;return{setters:[e=>{t=e.s},null,null],execute:function(){var r=Object.defineProperty,o=Object.defineProperties,n=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,c=(e,t,o)=>t in e?r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,a=(e,r)=>{for(var t in r||(r={}))s.call(r,t)&&c(e,t,r[t]);if(i)for(var t of i(r))d.call(r,t)&&c(e,t,r[t]);return e},l=(e,r)=>o(e,n(r)),u=(e,r,t)=>new Promise((o,n)=>{var i=e=>{try{d(t.next(e))}catch(r){n(r)}},s=e=>{try{d(t.throw(e))}catch(r){n(r)}},d=e=>e.done?o(e.value):Promise.resolve(e.value).then(i,s);d((t=t.apply(e,r)).next())});const g=e("getVideos",()=>u(void 0,null,function*(){try{const{data:e,error:r}=yield t.from("videos").select("*").order("order_index",{ascending:!0});if(r)throw r;return e||[]}catch(e){return console.error("Error fetching videos:",e),[]}})),v=(e("getCompletedVideos",()=>u(void 0,null,function*(){try{const{data:e,error:r}=yield t.from("videos").select("*").eq("status","completed").order("order_index",{ascending:!0});if(r)throw r;return e||[]}catch(e){return console.error("Error fetching completed videos:",e),[]}})),e("addVideo",e=>u(void 0,null,function*(){try{const r=l(a({id:`video_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},e),{created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()}),{data:o,error:n}=yield t.from("videos").insert([r]).select().single();if(n)throw n;return o}catch(r){return console.error("Error adding video:",r),null}})),e("updateVideo",(e,r)=>u(void 0,null,function*(){try{const{error:o}=yield t.from("videos").update(l(a({},r),{updated_at:(new Date).toISOString()})).eq("id",e);if(o)throw o;return!0}catch(o){return console.error("Error updating video:",o),!1}})),e("deleteVideo",e=>u(void 0,null,function*(){try{const{error:r}=yield t.from("videos").delete().eq("id",e);if(r)throw r;return!0}catch(r){return console.error("Error deleting video:",r),!1}})),e("reorderVideos",e=>u(void 0,null,function*(){try{const r=e.map((e,r)=>({id:e.id,order_index:r,updated_at:(new Date).toISOString()})),{error:o}=yield t.from("videos").upsert(r);if(o)throw o;return!0}catch(r){return console.error("Error reordering videos:",r),!1}})),e("getSettings",()=>u(void 0,null,function*(){try{const{data:e,error:r}=yield t.from("site_settings").select("*").eq("id","main").single();if(r)throw r;return e}catch(e){return console.error("Error fetching settings:",e),null}})));e("updateSettings",e=>u(void 0,null,function*(){try{const{error:r}=yield t.from("site_settings").update(l(a({},e),{updated_at:(new Date).toISOString()})).eq("id","main");if(r)throw r;return!0}catch(r){return console.error("Error updating settings:",r),!1}})),e("trackVisit",()=>u(void 0,null,function*(){try{const e=yield v(),r=(null==e?void 0:e.total_visits)||0;yield t.from("site_settings").update({total_visits:r+1,updated_at:(new Date).toISOString()}).eq("id","main")}catch(e){console.error("Error tracking visit:",e)}})),e("subscribeToVideos",e=>{const r=t.channel("videos_changes").on("postgres_changes",{event:"*",schema:"public",table:"videos"},()=>u(void 0,null,function*(){const r=yield g();e(r)})).subscribe();return()=>{t.removeChannel(r)}}),e("subscribeToSettings",e=>{const r=t.channel("settings_changes").on("postgres_changes",{event:"*",schema:"public",table:"site_settings"},()=>u(void 0,null,function*(){const r=yield v();e(r)})).subscribe();return()=>{t.removeChannel(r)}})}}});
