const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AdminPanel-tt10-kwz.js","assets/react-vendor-9mwbaf1v.js","assets/icons-D3sHNqvn.js","assets/supabaseData-PmD0rX_k.js"])))=>i.map(i=>d[i]);
import{r as e,a as t,g as s,c as r}from"./react-vendor-9mwbaf1v.js";import{G as n,C as i,S as o,H as a,M as l,a as c,b as h,X as d,c as u,d as p,e as f,I as m,Y as g,P as v,f as b}from"./icons-D3sHNqvn.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var y={exports:{}},w={},_=e,x=Symbol.for("react.element"),k=Symbol.for("react.fragment"),j=Object.prototype.hasOwnProperty,S=_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,T={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,s){var r,n={},i=null,o=null;for(r in void 0!==s&&(i=""+s),void 0!==t.key&&(i=""+t.key),void 0!==t.ref&&(o=t.ref),t)j.call(t,r)&&!T.hasOwnProperty(r)&&(n[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===n[r]&&(n[r]=t[r]);return{$$typeof:x,type:e,key:i,ref:o,props:n,_owner:S.current}}w.Fragment=k,w.jsx=E,w.jsxs=E,y.exports=w;var O,P=y.exports,C=t;O=C.createRoot,C.hydrateRoot;const N={},A=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),s=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));r=Promise.allSettled(t.map(e=>{if((e=function(e){return"/Esther_Platform/"+e}(e))in N)return;N[e]=!0;const t=e.endsWith(".css"),r=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${r}`))return;const n=document.createElement("link");return n.rel=t?"stylesheet":"modulepreload",t||(n.as="script"),n.crossOrigin="",n.href=e,s&&n.setAttribute("nonce",s),document.head.appendChild(n),t?new Promise((t,s)=>{n.addEventListener("load",t),n.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function n(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(const e of t||[])"rejected"===e.status&&n(e.reason);return e().catch(n)})};function I(e){return n({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"},child:[]}]})(e)}function $(e){return n({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M448,209.91a210.06,210.06,0,0,1-122.77-39.25V349.38A162.55,162.55,0,1,1,185,188.31V278.2a74.62,74.62,0,1,0,52.23,71.18V0l88,0a121.18,121.18,0,0,0,1.86,22.17h0A122.18,122.18,0,0,0,381,102.39a121.43,121.43,0,0,0,67,20.14Z"},child:[]}]})(e)}const R=()=>P.jsx("div",{className:"fixed inset-0 bg-gray-950 flex items-center justify-center z-50",children:P.jsxs("div",{className:"relative",children:[P.jsxs("div",{className:"w-32 h-32 relative",children:[P.jsx("div",{className:"absolute inset-0 border-4 border-purple-600/30 rounded-full"}),P.jsx("div",{className:"absolute inset-0 border-4 border-transparent border-t-purple-600 rounded-full animate-spin"}),P.jsx("div",{className:"absolute inset-2 border-4 border-transparent border-t-pink-600 rounded-full animate-spin-slow"}),P.jsx("div",{className:"absolute inset-4 border-4 border-transparent border-t-blue-600 rounded-full animate-spin-reverse"})]}),P.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:P.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-600 to-pink-600 rounded-full animate-pulse"})}),P.jsx("div",{className:"mt-8 text-center",children:P.jsx("p",{className:"text-white text-xl font-bold animate-pulse neon-text",children:"Loading..."})})]})});function L(){const t=e.useRef(null);return e.useEffect(()=>{const e=t.current;if(!e)return;const s=e.getContext("webgl")||e.getContext("experimental-webgl");if(!s)return;const r=()=>{e.width=window.innerWidth,e.height=window.innerHeight,s.viewport(0,0,e.width,e.height)};r(),window.addEventListener("resize",r);const n=(e,t)=>{const r=s.createShader(t);return r?(s.shaderSource(r,e),s.compileShader(r),s.getShaderParameter(r,s.COMPILE_STATUS)?r:(s.deleteShader(r),null)):null},i=n("\n      attribute vec2 a_position;\n      varying vec2 v_uv;\n      void main() {\n        gl_Position = vec4(a_position, 0.0, 1.0);\n        v_uv = a_position * 0.5 + 0.5;\n      }\n    ",s.VERTEX_SHADER),o=n("\n      precision mediump float;\n      uniform float u_time;\n      uniform vec2 u_resolution;\n      varying vec2 v_uv;\n      \n      // Noise function for organic wave patterns\n      float noise(vec2 p) {\n        return fract(sin(dot(p, vec2(12.9898, 78.233))) * 43758.5453);\n      }\n      \n      // Smooth noise\n      float smoothNoise(vec2 p) {\n        vec2 i = floor(p);\n        vec2 f = fract(p);\n        f = f * f * (3.0 - 2.0 * f);\n        \n        float a = noise(i);\n        float b = noise(i + vec2(1.0, 0.0));\n        float c = noise(i + vec2(0.0, 1.0));\n        float d = noise(i + vec2(1.0, 1.0));\n        \n        return mix(mix(a, b, f.x), mix(c, d, f.x), f.y);\n      }\n      \n      // Multiple octaves for flowing effect\n      float fbm(vec2 p) {\n        float value = 0.0;\n        float amplitude = 0.5;\n        for(int i = 0; i < 4; i++) {\n          value += amplitude * smoothNoise(p);\n          p *= 2.0;\n          amplitude *= 0.5;\n        }\n        return value;\n      }\n      \n      void main() {\n        vec2 uv = v_uv;\n        vec2 p = uv * 3.0;\n        \n        // Animate the waves\n        p.y += u_time * 0.2;\n        p.x += sin(u_time * 0.15) * 0.3;\n        \n        // Create flowing wave patterns\n        float wave1 = sin(p.y * 2.0 + u_time * 0.5) * 0.5 + 0.5;\n        float wave2 = sin(p.x * 1.5 + p.y * 2.5 + u_time * 0.3) * 0.5 + 0.5;\n        float wave3 = fbm(p * 0.8 + vec2(u_time * 0.1, u_time * 0.15));\n        \n        // Combine waves for flowing effect\n        float combined = wave1 * 0.4 + wave2 * 0.3 + wave3 * 0.3;\n        \n        // Create depth with multiple layers\n        float depth1 = smoothstep(0.3, 0.7, combined);\n        float depth2 = smoothstep(0.5, 0.9, combined);\n        float depth3 = smoothstep(0.7, 1.0, combined);\n        \n        // Purple color palette matching the image\n        // Deep black base\n        vec3 baseColor = vec3(0.0, 0.0, 0.0);\n        \n        // Deep purple shadows (plum/indigo)\n        vec3 shadowColor = vec3(0.15, 0.05, 0.25);\n        \n        // Medium purple\n        vec3 midColor = vec3(0.35, 0.15, 0.50);\n        \n        // Vibrant purple highlights (magenta-purple)\n        vec3 highlightColor = vec3(0.65, 0.25, 0.85);\n        \n        // Bright magenta highlights\n        vec3 brightColor = vec3(0.85, 0.40, 0.95);\n        \n        // Mix colors based on depth - More visible waves\n        vec3 color = baseColor;\n        color = mix(color, shadowColor, depth1 * 0.8);\n        color = mix(color, midColor, depth2 * 0.7);\n        color = mix(color, highlightColor, depth3 * 0.6);\n        color = mix(color, brightColor, smoothstep(0.85, 1.0, combined) * 0.5);\n        \n        // Add subtle lighting from top-left\n        vec2 lightDir = normalize(vec2(-0.5, -0.5));\n        vec2 toLight = lightDir;\n        float light = dot(normalize(vec2(combined - 0.5, 0.1)), toLight) * 0.5 + 0.5;\n        color *= (0.8 + light * 0.4);\n        \n        // Add subtle texture overlay\n        float texture = smoothNoise(uv * 20.0 + u_time * 0.1) * 0.05 + 0.95;\n        color *= texture;\n        \n        // Make waves more visible - higher alpha\n        float alpha = max(combined * 1.2, 0.3);\n        \n        gl_FragColor = vec4(color, alpha);\n      }\n    ",s.FRAGMENT_SHADER);if(!i||!o)return;const a=s.createProgram();if(!a)return;if(s.attachShader(a,i),s.attachShader(a,o),s.linkProgram(a),!s.getProgramParameter(a,s.LINK_STATUS))return;s.useProgram(a);const l=s.getAttribLocation(a,"a_position"),c=s.getUniformLocation(a,"u_time"),h=s.getUniformLocation(a,"u_resolution"),d=s.createBuffer();s.bindBuffer(s.ARRAY_BUFFER,d);const u=new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]);let p;s.bufferData(s.ARRAY_BUFFER,u,s.STATIC_DRAW),s.enable(s.BLEND),s.blendFunc(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA);let f=Date.now();const m=()=>{const t=(Date.now()-f)/1e3;s.uniform1f(c,t),s.uniform2f(h,e.width,e.height),s.enableVertexAttribArray(l),s.bindBuffer(s.ARRAY_BUFFER,d),s.vertexAttribPointer(l,2,s.FLOAT,!1,0,0),s.clearColor(0,0,0,1),s.clear(s.COLOR_BUFFER_BIT),s.drawArrays(s.TRIANGLES,0,6),p=requestAnimationFrame(m)};return m(),()=>{window.removeEventListener("resize",r),cancelAnimationFrame(p),s.deleteProgram(a),s.deleteShader(i),s.deleteShader(o)}},[]),P.jsxs(P.Fragment,{children:[P.jsx("canvas",{ref:t,className:"fixed inset-0 w-full h-full pointer-events-none",style:{zIndex:0}}),P.jsx("div",{className:"fixed inset-0 pointer-events-none",style:{background:"radial-gradient(ellipse at top left, rgba(168, 85, 247, 0.15) 0%, rgba(107, 33, 168, 0.1) 30%, #000000 70%)",zIndex:0}}),P.jsx("div",{className:"fixed inset-0 pointer-events-none opacity-40",style:{background:"radial-gradient(circle at 30% 20%, rgba(168, 85, 247, 0.2) 0%, transparent 50%)",zIndex:1}})]})}class U extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class D extends U{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class B extends U{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class z extends U{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var q,M;(M=q||(q={})).Any="any",M.ApNortheast1="ap-northeast-1",M.ApNortheast2="ap-northeast-2",M.ApSouth1="ap-south-1",M.ApSoutheast1="ap-southeast-1",M.ApSoutheast2="ap-southeast-2",M.CaCentral1="ca-central-1",M.EuCentral1="eu-central-1",M.EuWest1="eu-west-1",M.EuWest2="eu-west-2",M.EuWest3="eu-west-3",M.SaEast1="sa-east-1",M.UsEast1="us-east-1",M.UsWest1="us-west-1",M.UsWest2="us-west-2";var W=function(e,t,s,r){return new(s||(s=Promise))(function(n,i){function o(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(o,a)}l((r=r.apply(e,t||[])).next())})};class F{constructor(e,{headers:t={},customFetch:s,region:r=q.Any}={}){this.url=e,this.headers=t,this.region=r,this.fetch=(e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>A(async()=>{const{default:e}=await Promise.resolve().then(()=>re);return{default:e}},void 0).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)})(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return W(this,void 0,void 0,function*(){try{const{headers:r,method:n,body:i}=t;let o={},{region:a}=t;a||(a=this.region);const l=new URL(`${this.url}/${e}`);let c;a&&"any"!==a&&(o["x-region"]=a,l.searchParams.set("forceFunctionRegion",a)),i&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&("undefined"!=typeof Blob&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",c=i):"string"==typeof i?(o["Content-Type"]="text/plain",c=i):"undefined"!=typeof FormData&&i instanceof FormData?c=i:(o["Content-Type"]="application/json",c=JSON.stringify(i)));const h=yield this.fetch(l.toString(),{method:n||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),r),body:c}).catch(e=>{throw new D(e)}),d=h.headers.get("x-relay-error");if(d&&"true"===d)throw new B(h);if(!h.ok)throw new z(h);let u,p=(null!==(s=h.headers.get("Content-Type"))&&void 0!==s?s:"text/plain").split(";")[0].trim();return u="application/json"===p?yield h.json():"application/octet-stream"===p?yield h.blob():"text/event-stream"===p?h:"multipart/form-data"===p?yield h.formData():yield h.text(),{data:u,error:null,response:h}}catch(r){return{data:null,error:r,response:r instanceof z||r instanceof B?r.context:void 0}}})}}var K={},H={},J={},V={},G={},Y={},X=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();const Q=X.fetch,Z=X.fetch.bind(X),ee=X.Headers,te=X.Request,se=X.Response,re=Object.freeze(Object.defineProperty({__proto__:null,Headers:ee,Request:te,Response:se,default:Z,fetch:Q},Symbol.toStringTag,{value:"Module"})),ne=s(re);var ie={};Object.defineProperty(ie,"__esModule",{value:!0});let oe=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};ie.default=oe;var ae=r&&r.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Y,"__esModule",{value:!0});const le=ae(ne),ce=ae(ie);Y.default=class{constructor(e){var t,s;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=null!==(t=e.shouldThrowOnError)&&void 0!==t&&t,this.signal=e.signal,this.isMaybeSingle=null!==(s=e.isMaybeSingle)&&void 0!==s&&s,e.fetch?this.fetch=e.fetch:"undefined"==typeof fetch?this.fetch=le.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let s=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,s,r,n;let i=null,o=null,a=null,l=e.status,c=e.statusText;if(e.ok){if("HEAD"!==this.method){const s=await e.text();""===s||(o="text/csv"===this.headers.get("Accept")||this.headers.get("Accept")&&(null===(t=this.headers.get("Accept"))||void 0===t?void 0:t.includes("application/vnd.pgrst.plan+text"))?s:JSON.parse(s))}const n=null===(s=this.headers.get("Prefer"))||void 0===s?void 0:s.match(/count=(exact|planned|estimated)/),h=null===(r=e.headers.get("content-range"))||void 0===r?void 0:r.split("/");n&&h&&h.length>1&&(a=parseInt(h[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(o)&&(o.length>1?(i={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,a=null,l=406,c="Not Acceptable"):o=1===o.length?o[0]:null)}else{const t=await e.text();try{i=JSON.parse(t),Array.isArray(i)&&404===e.status&&(o=[],i=null,l=200,c="OK")}catch(h){404===e.status&&""===t?(l=204,c="No Content"):i={message:t}}if(i&&this.isMaybeSingle&&(null===(n=null==i?void 0:i.details)||void 0===n?void 0:n.includes("0 rows"))&&(i=null,l=200,c="OK"),i&&this.shouldThrowOnError)throw new ce.default(i)}return{error:i,data:o,count:a,status:l,statusText:c}});return this.shouldThrowOnError||(s=s.catch(e=>{var t,s,r;return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:`${null!==(s=null==e?void 0:e.stack)&&void 0!==s?s:""}`,hint:"",code:`${null!==(r=null==e?void 0:e.code)&&void 0!==r?r:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}};var he=r&&r.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(G,"__esModule",{value:!0});const de=he(Y);let ue=class extends de.default{select(e){let t=!1;const s=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",s),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:s,foreignTable:r,referencedTable:n=r}={}){const i=n?`${n}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${void 0===s?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:s=t}={}){const r=void 0===s?"limit":`${s}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t,{foreignTable:s,referencedTable:r=s}={}){const n=void 0===r?"offset":`${r}.offset`,i=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this.url.searchParams.set(i,""+(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:r=!1,wal:n=!1,format:i="text"}={}){var o;const a=[e?"analyze":null,t?"verbose":null,s?"settings":null,r?"buffers":null,n?"wal":null].filter(Boolean).join("|"),l=null!==(o=this.headers.get("Accept"))&&void 0!==o?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${l}"; options=${a};`),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};G.default=ue;var pe=r&&r.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(V,"__esModule",{value:!0});const fe=pe(G);let me=class extends fe.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const s=Array.from(new Set(t)).map(e=>"string"==typeof e&&new RegExp("[,()]").test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:s,type:r}={}){let n="";"plain"===r?n="pl":"phrase"===r?n="ph":"websearch"===r&&(n="w");const i=void 0===s?"":`(${s})`;return this.url.searchParams.append(e,`${n}fts${i}.${t}`),this}match(e){return Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e,{foreignTable:t,referencedTable:s=t}={}){const r=s?`${s}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}};V.default=me;var ge=r&&r.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(J,"__esModule",{value:!0});const ve=ge(V);J.default=class{constructor(e,{headers:t={},schema:s,fetch:r}){this.url=e,this.headers=new Headers(t),this.schema=s,this.fetch=r}select(e,{head:t=!1,count:s}={}){const r=t?"HEAD":"GET";let n=!1;const i=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!n?"":('"'===e&&(n=!n),e)).join("");return this.url.searchParams.set("select",i),s&&this.headers.append("Prefer",`count=${s}`),new ve.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:s=!0}={}){var r;if(t&&this.headers.append("Prefer",`count=${t}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new ve.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(r=this.fetch)&&void 0!==r?r:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:s=!1,count:r,defaultToNull:n=!0}={}){var i;if(this.headers.append("Prefer",`resolution=${s?"ignore":"merge"}-duplicates`),void 0!==t&&this.url.searchParams.set("on_conflict",t),r&&this.headers.append("Prefer",`count=${r}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new ve.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(i=this.fetch)&&void 0!==i?i:fetch})}update(e,{count:t}={}){var s;return t&&this.headers.append("Prefer",`count=${t}`),new ve.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(s=this.fetch)&&void 0!==s?s:fetch})}delete({count:e}={}){var t;return e&&this.headers.append("Prefer",`count=${e}`),new ve.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:null!==(t=this.fetch)&&void 0!==t?t:fetch})}};var be=r&&r.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(H,"__esModule",{value:!0});const ye=be(J),we=be(V);H.default=class e{constructor(e,{headers:t={},schema:s,fetch:r}={}){this.url=e,this.headers=new Headers(t),this.schemaName=s,this.fetch=r}from(e){const t=new URL(`${this.url}/${e}`);return new ye.default(t,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new e(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:r=!1,count:n}={}){var i;let o;const a=new URL(`${this.url}/rpc/${e}`);let l;s||r?(o=s?"HEAD":"GET",Object.entries(t).filter(([e,t])=>void 0!==t).map(([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`]).forEach(([e,t])=>{a.searchParams.append(e,t)})):(o="POST",l=t);const c=new Headers(this.headers);return n&&c.set("Prefer",`count=${n}`),new we.default({method:o,url:a,headers:c,schema:this.schemaName,body:l,fetch:null!==(i=this.fetch)&&void 0!==i?i:fetch})}};var _e=r&&r.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(K,"__esModule",{value:!0}),K.PostgrestError=K.PostgrestBuilder=K.PostgrestTransformBuilder=K.PostgrestFilterBuilder=K.PostgrestQueryBuilder=K.PostgrestClient=void 0;const xe=_e(H);K.PostgrestClient=xe.default;const ke=_e(J);K.PostgrestQueryBuilder=ke.default;const je=_e(V);K.PostgrestFilterBuilder=je.default;const Se=_e(G);K.PostgrestTransformBuilder=Se.default;const Te=_e(Y);K.PostgrestBuilder=Te.default;const Ee=_e(ie);K.PostgrestError=Ee.default;var Oe=K.default={PostgrestClient:xe.default,PostgrestQueryBuilder:ke.default,PostgrestFilterBuilder:je.default,PostgrestTransformBuilder:Se.default,PostgrestBuilder:Te.default,PostgrestError:Ee.default};const{PostgrestClient:Pe,PostgrestQueryBuilder:Ce,PostgrestFilterBuilder:Ne,PostgrestTransformBuilder:Ae,PostgrestBuilder:Ie,PostgrestError:$e}=Oe;class Re{static detectEnvironment(){var e;if("undefined"!=typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if("undefined"!=typeof global&&void 0!==global.WebSocket)return{type:"native",constructor:global.WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocketPair&&void 0===globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!=typeof globalThis&&globalThis.EdgeRuntime||"undefined"!=typeof navigator&&(null===(e=navigator.userAgent)||void 0===e?void 0:e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if("undefined"!=typeof process){const e=process.versions;if(e&&e.node){const t=e.node,s=parseInt(t.replace(/^v/,"").split(".")[0]);return s>=22?void 0!==globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`\n\nSuggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){return new(this.getWebSocketConstructor())(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return"native"===e.type||"ws"===e.type}catch(e){return!1}}}const Le=1e4;var Ue,De,Be,ze,qe,Me,We,Fe,Ke,He,Je;(De=Ue||(Ue={}))[De.connecting=0]="connecting",De[De.open=1]="open",De[De.closing=2]="closing",De[De.closed=3]="closed",(ze=Be||(Be={})).closed="closed",ze.errored="errored",ze.joined="joined",ze.joining="joining",ze.leaving="leaving",(Me=qe||(qe={})).close="phx_close",Me.error="phx_error",Me.join="phx_join",Me.reply="phx_reply",Me.leave="phx_leave",Me.access_token="access_token",(We||(We={})).websocket="websocket",(Ke=Fe||(Fe={})).Connecting="connecting",Ke.Open="open",Ke.Closing="closing",Ke.Closed="closed";class Ve{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"==typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const r=t.getUint8(1),n=t.getUint8(2);let i=this.HEADER_LENGTH+2;const o=s.decode(e.slice(i,i+r));i+=r;const a=s.decode(e.slice(i,i+n));i+=n;return{ref:null,topic:o,event:a,payload:JSON.parse(s.decode(e.slice(i,e.byteLength)))}}}class Ge{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}(Je=He||(He={})).abstime="abstime",Je.bool="bool",Je.date="date",Je.daterange="daterange",Je.float4="float4",Je.float8="float8",Je.int2="int2",Je.int4="int4",Je.int4range="int4range",Je.int8="int8",Je.int8range="int8range",Je.json="json",Je.jsonb="jsonb",Je.money="money",Je.numeric="numeric",Je.oid="oid",Je.reltime="reltime",Je.text="text",Je.time="time",Je.timestamp="timestamp",Je.timestamptz="timestamptz",Je.timetz="timetz",Je.tsrange="tsrange",Je.tstzrange="tstzrange";const Ye=(e,t,s={})=>{var r;const n=null!==(r=s.skipTypes)&&void 0!==r?r:[];return Object.keys(t).reduce((s,r)=>(s[r]=Xe(r,e,t,n),s),{})},Xe=(e,t,s,r)=>{const n=t.find(t=>t.name===e),i=null==n?void 0:n.type,o=s[e];return i&&!r.includes(i)?Qe(i,o):Ze(o)},Qe=(e,t)=>{if("_"===e.charAt(0)){const s=e.slice(1,e.length);return rt(t,s)}switch(e){case He.bool:return et(t);case He.float4:case He.float8:case He.int2:case He.int4:case He.int8:case He.numeric:case He.oid:return tt(t);case He.json:case He.jsonb:return st(t);case He.timestamp:return nt(t);case He.abstime:case He.date:case He.daterange:case He.int4range:case He.int8range:case He.money:case He.reltime:case He.text:case He.time:case He.timestamptz:case He.timetz:case He.tsrange:case He.tstzrange:default:return Ze(t)}},Ze=e=>e,et=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},tt=e=>{if("string"==typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},st=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(t){return e}return e},rt=(e,t)=>{if("string"!=typeof e)return e;const s=e.length-1,r=e[s];if("{"===e[0]&&"}"===r){let r;const i=e.slice(1,s);try{r=JSON.parse("["+i+"]")}catch(n){r=i?i.split(","):[]}return r.map(e=>Qe(t,e))}return e},nt=e=>"string"==typeof e?e.replace(" ","T"):e,it=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class ot{constructor(e,t,s={},r=1e4){this.channel=e,this.event=t,this.payload=s,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t(null===(s=this.receivedResp)||void 0===s?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var at,lt,ct,ht,dt,ut,pt,ft;(lt=at||(at={})).SYNC="sync",lt.JOIN="join",lt.LEAVE="leave";class mt{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},e=>{const{onJoin:t,onLeave:s,onSync:r}=this.caller;this.joinRef=this.channel._joinRef(),this.state=mt.syncState(this.state,e,t,s),this.pendingDiffs.forEach(e=>{this.state=mt.syncDiff(this.state,e,t,s)}),this.pendingDiffs=[],r()}),this.channel._on(s.diff,{},e=>{const{onJoin:t,onLeave:s,onSync:r}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=mt.syncDiff(this.state,e,t,s),r())}),this.onJoin((e,t,s)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:s})}),this.onLeave((e,t,s)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,r){const n=this.cloneDeep(e),i=this.transformState(t),o={},a={};return this.map(n,(e,t)=>{i[e]||(a[e]=t)}),this.map(i,(e,t)=>{const s=n[e];if(s){const r=t.map(e=>e.presence_ref),n=s.map(e=>e.presence_ref),i=t.filter(e=>n.indexOf(e.presence_ref)<0),l=s.filter(e=>r.indexOf(e.presence_ref)<0);i.length>0&&(o[e]=i),l.length>0&&(a[e]=l)}else o[e]=t}),this.syncDiff(n,{joins:o,leaves:a},s,r)}static syncDiff(e,t,s,r){const{joins:n,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),r||(r=()=>{}),this.map(n,(t,r)=>{var n;const i=null!==(n=e[t])&&void 0!==n?n:[];if(e[t]=this.cloneDeep(r),i.length>0){const s=e[t].map(e=>e.presence_ref),r=i.filter(e=>s.indexOf(e.presence_ref)<0);e[t].unshift(...r)}s(t,i,r)}),this.map(i,(t,s)=>{let n=e[t];if(!n)return;const i=s.map(e=>e.presence_ref);n=n.filter(e=>i.indexOf(e.presence_ref)<0),e[t]=n,r(t,n,s),0===n.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const r=e[s];return t[s]="metas"in r?r.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):r,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(ht=ct||(ct={})).ALL="*",ht.INSERT="INSERT",ht.UPDATE="UPDATE",ht.DELETE="DELETE",(ut=dt||(dt={})).BROADCAST="broadcast",ut.PRESENCE="presence",ut.POSTGRES_CHANGES="postgres_changes",ut.SYSTEM="system",(ft=pt||(pt={})).SUBSCRIBED="SUBSCRIBED",ft.TIMED_OUT="TIMED_OUT",ft.CLOSED="CLOSED",ft.CHANNEL_ERROR="CHANNEL_ERROR";class gt{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=Be.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new ot(this,qe.join,this.params,this.timeout),this.rejoinTimer=new Ge(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Be.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Be.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=Be.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Be.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=Be.errored,this.rejoinTimer.scheduleTimeout())}),this._on(qe.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new mt(this),this.broadcastEndpointURL=it(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,r,n;if(this.socket.isConnected()||this.socket.connect(),this.state==Be.closed){const{config:{broadcast:i,presence:o,private:a}}=this.params,l=null!==(r=null===(s=this.bindings.postgres_changes)||void 0===s?void 0:s.map(e=>e.filter))&&void 0!==r?r:[],c=!!this.bindings[dt.PRESENCE]&&this.bindings[dt.PRESENCE].length>0||!0===(null===(n=this.params.config.presence)||void 0===n?void 0:n.enabled),h={},d={broadcast:i,presence:Object.assign(Object.assign({},o),{enabled:c}),postgres_changes:l,private:a};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(t=>null==e?void 0:e(pt.CHANNEL_ERROR,t)),this._onClose(()=>null==e?void 0:e(pt.CLOSED)),this.updateJoinPayload(Object.assign({config:d},h)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:t})=>{var s;if(this.socket.setAuth(),void 0!==t){const r=this.bindings.postgres_changes,n=null!==(s=null==r?void 0:r.length)&&void 0!==s?s:0,i=[];for(let s=0;s<n;s++){const n=r[s],{filter:{event:o,schema:a,table:l,filter:c}}=n,h=t&&t[s];if(!h||h.event!==o||h.schema!==a||h.table!==l||h.filter!==c)return this.unsubscribe(),this.state=Be.errored,void(null==e||e(pt.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));i.push(Object.assign(Object.assign({},n),{id:h.id}))}return this.bindings.postgres_changes=i,void(e&&e(pt.SUBSCRIBED))}null==e||e(pt.SUBSCRIBED)}).receive("error",t=>{this.state=Be.errored,null==e||e(pt.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null==e||e(pt.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this.state===Be.joined&&e===dt.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,s)}async send(e,t={}){var s,r;if(this._canPush()||"broadcast"!==e.type)return new Promise(s=>{var r,n,i;const o=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(i=null===(n=null===(r=this.params)||void 0===r?void 0:r.config)||void 0===n?void 0:n.broadcast)||void 0===i?void 0:i.ack)||s("ok"),o.receive("ok",()=>s("ok")),o.receive("error",()=>s("error")),o.receive("timeout",()=>s("timed out"))});{const{event:i,payload:o}=e,a={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,a,null!==(s=t.timeout)&&void 0!==s?s:this.timeout);return await(null===(r=e.body)||void 0===r?void 0:r.cancel()),e.ok?"ok":"error"}catch(n){return"AbortError"===n.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Be.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(qe.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(r=>{s=new ot(this,qe.leave,{},e),s.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{null==s||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Be.closed,this.bindings={}}async _fetchWithTimeout(e,t,s){const r=new AbortController,n=setTimeout(()=>r.abort(),s),i=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(n),i}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new ot(this,e,t,s);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>100){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var r,n;const i=e.toLocaleLowerCase(),{close:o,error:a,leave:l,join:c}=qe;if(s&&[o,a,l,c].indexOf(i)>=0&&s!==this._joinRef())return;let h=this._onMessage(i,t,s);if(t&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?null===(r=this.bindings.postgres_changes)||void 0===r||r.filter(e=>{var t,s,r;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(r=null===(s=e.filter)||void 0===s?void 0:s.event)||void 0===r?void 0:r.toLocaleLowerCase())===i}).map(e=>e.callback(h,s)):null===(n=this.bindings[i])||void 0===n||n.filter(e=>{var s,r,n,o,a,l;if(["broadcast","presence","postgres_changes"].includes(i)){if("id"in e){const i=e.id,o=null===(s=e.filter)||void 0===s?void 0:s.event;return i&&(null===(r=t.ids)||void 0===r?void 0:r.includes(i))&&("*"===o||(null==o?void 0:o.toLocaleLowerCase())===(null===(n=t.data)||void 0===n?void 0:n.type.toLocaleLowerCase()))}{const s=null===(a=null===(o=null==e?void 0:e.filter)||void 0===o?void 0:o.event)||void 0===a?void 0:a.toLocaleLowerCase();return"*"===s||s===(null===(l=null==t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===i}).map(e=>{if("object"==typeof h&&"ids"in h){const e=h.data,{schema:t,table:s,commit_timestamp:r,type:n,errors:i}=e,o={schema:t,table:s,commit_timestamp:r,eventType:n,new:{},old:{},errors:i};h=Object.assign(Object.assign({},o),this._getPayloadRecords(e))}e.callback(h,s)})}_isClosed(){return this.state===Be.closed}_isJoined(){return this.state===Be.joined}_isJoining(){return this.state===Be.joining}_isLeaving(){return this.state===Be.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const r=e.toLocaleLowerCase(),n={type:r,filter:t,callback:s};return this.bindings[r]?this.bindings[r].push(n):this.bindings[r]=[n],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(e=>{var r;return!((null===(r=e.type)||void 0===r?void 0:r.toLocaleLowerCase())===s&&gt.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(qe.close,{},e)}_onError(e){this._on(qe.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Be.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=Ye(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=Ye(e.columns,e.old_record)),t}}const vt=()=>{},bt=25e3,yt=10,wt=100,_t=[1e3,2e3,5e3,1e4];class xt{constructor(e,t){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Le,this.transport=null,this.heartbeatIntervalMs=bt,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=vt,this.ref=0,this.reconnectTimer=null,this.logger=vt,this.conn=null,this.sendBuffer=[],this.serializer=new Ve,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>A(async()=>{const{default:e}=await Promise.resolve().then(()=>re);return{default:e}},void 0).then(({default:t})=>t(...e)).catch(e=>{throw new Error(`Failed to load @supabase/node-fetch: ${e.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):fetch),(...e)=>t(...e)},!(null===(s=null==t?void 0:t.params)||void 0===s?void 0:s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${We.websocket}`,this.httpEndpoint=it(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null==t?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Re.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;if(t.includes("Node.js"))throw new Error(`${t}\n\nTo use Realtime in Node.js, you need to provide a WebSocket implementation:\n\nOption 1: Use Node.js 22+ which has native WebSocket support\nOption 2: Install and provide the "ws" package:\n\n  npm install ws\n\n  import ws from "ws"\n  const client = new RealtimeClient(url, {\n    ...options,\n    transport: ws\n  })`);throw new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Ue.connecting:return Fe.Connecting;case Ue.open:return Fe.Open;case Ue.closing:return Fe.Closing;default:return Fe.Closed}}isConnected(){return this.connectionState()===Fe.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(e,t={config:{}}){const s=`realtime:${e}`,r=this.getChannels().find(e=>e.topic===s);if(r)return r;{const s=new gt(`realtime:${e}`,t,this);return this.channels.push(s),s}}push(e){const{topic:t,event:s,payload:r,ref:n}=e,i=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push",`${t} ${s} (${n})`,r),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}return this._wasManualDisconnect=!1,null===(e=this.conn)||void 0===e||e.close(1e3,"heartbeat timeout"),void setTimeout(()=>{var e;this.isConnected()||null===(e=this.reconnectTimer)||void 0===e||e.scheduleTimeout()},wt)}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}else try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,e=>{if("phoenix"===e.topic&&"phx_reply"===e.event)try{this.heartbeatCallback("ok"===e.payload.status?"ok":"error")}catch(a){this.log("error","error in heartbeat callback",a)}e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:t,event:s,payload:r,ref:n}=e,i=n?`(${n})`:"",o=r.status||"";this.log("receive",`${o} ${t} ${s} ${i}`.trim(),r),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(s,r,n)),this._triggerStateCallbacks("message",e)})}_clearTimer(e){var t;"heartbeat"===e&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===e&&(null===(t=this.reconnectTimer)||void 0===t||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null===(t=this.reconnectTimer)||void 0===t||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(qe.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const s=e.match(/\?/)?"&":"?";return`${e}${s}${new URLSearchParams(t)}`}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}_setConnectionState(e,t=!1){this._connectionState=e,"connecting"===e?this._wasManualDisconnect=!1:"disconnecting"===e&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;t=e||(this.accessToken?await this.accessToken():this.accessTokenValue),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(e=>{const s={access_token:t,version:"realtime-js/2.15.5"};t&&e.updateJoinPayload(s),e.joinedOnce&&e._isJoined()&&e._push(qe.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(t)}catch(r){this.log("error",`error in ${e} callback`,r)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new Ge(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},yt)},this.reconnectAfterMs)}_initializeOptions(e){var t,s,r,n,i,o,a,l,c;if(this.transport=null!==(t=null==e?void 0:e.transport)&&void 0!==t?t:null,this.timeout=null!==(s=null==e?void 0:e.timeout)&&void 0!==s?s:Le,this.heartbeatIntervalMs=null!==(r=null==e?void 0:e.heartbeatIntervalMs)&&void 0!==r?r:bt,this.worker=null!==(n=null==e?void 0:e.worker)&&void 0!==n&&n,this.accessToken=null!==(i=null==e?void 0:e.accessToken)&&void 0!==i?i:null,this.heartbeatCallback=null!==(o=null==e?void 0:e.heartbeatCallback)&&void 0!==o?o:vt,(null==e?void 0:e.params)&&(this.params=e.params),(null==e?void 0:e.logger)&&(this.logger=e.logger),((null==e?void 0:e.logLevel)||(null==e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!==(a=null==e?void 0:e.reconnectAfterMs)&&void 0!==a?a:e=>_t[e-1]||1e4,this.encode=null!==(l=null==e?void 0:e.encode)&&void 0!==l?l:(e,t)=>t(JSON.stringify(e)),this.decode=null!==(c=null==e?void 0:e.decode)&&void 0!==c?c:this.serializer.decode.bind(this.serializer),this.worker){if("undefined"!=typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=null==e?void 0:e.workerUrl}}}class kt extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function jt(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class St extends kt{constructor(e,t,s){super(e),this.name="StorageApiError",this.status=t,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Tt extends kt{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Et=function(e,t,s,r){return new(s||(s=Promise))(function(n,i){function o(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(o,a)}l((r=r.apply(e,t||[])).next())})};const Ot=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>A(async()=>{const{default:e}=await Promise.resolve().then(()=>re);return{default:e}},void 0).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},Pt=e=>{if(Array.isArray(e))return e.map(e=>Pt(e));if("function"==typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([e,s])=>{const r=e.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""));t[r]=Pt(s)}),t};var Ct=function(e,t,s,r){return new(s||(s=Promise))(function(n,i){function o(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(o,a)}l((r=r.apply(e,t||[])).next())})};const Nt=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),At=(e,t,s)=>Ct(void 0,void 0,void 0,function*(){const r=yield Et(void 0,void 0,void 0,function*(){return"undefined"==typeof Response?(yield A(()=>Promise.resolve().then(()=>re),void 0)).Response:Response});e instanceof r&&!(null==s?void 0:s.noResolveJson)?e.json().then(s=>{const r=e.status||500,n=(null==s?void 0:s.statusCode)||r+"";t(new St(Nt(s),r,n))}).catch(e=>{t(new Tt(Nt(e),e))}):t(new Tt(Nt(e),e))}),It=(e,t,s,r)=>{const n={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"!==e&&r?((e=>{if("object"!=typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)})(r)?(n.headers=Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers),n.body=JSON.stringify(r)):n.body=r,(null==t?void 0:t.duplex)&&(n.duplex=t.duplex),Object.assign(Object.assign({},n),s)):n};function $t(e,t,s,r,n,i){return Ct(this,void 0,void 0,function*(){return new Promise((o,a)=>{e(s,It(t,r,n,i)).then(e=>{if(!e.ok)throw e;return(null==r?void 0:r.noResolveJson)?e:e.json()}).then(e=>o(e)).catch(e=>At(e,a,r))})})}function Rt(e,t,s,r){return Ct(this,void 0,void 0,function*(){return $t(e,"GET",t,s,r)})}function Lt(e,t,s,r,n){return Ct(this,void 0,void 0,function*(){return $t(e,"POST",t,r,n,s)})}function Ut(e,t,s,r,n){return Ct(this,void 0,void 0,function*(){return $t(e,"PUT",t,r,n,s)})}function Dt(e,t,s,r,n){return Ct(this,void 0,void 0,function*(){return $t(e,"DELETE",t,r,n,s)})}var Bt=function(e,t,s,r){return new(s||(s=Promise))(function(n,i){function o(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(o,a)}l((r=r.apply(e,t||[])).next())})};const zt={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},qt={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Mt{constructor(e,t={},s,r){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=s,this.fetch=Ot(r)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,s,r){return Bt(this,void 0,void 0,function*(){try{let n;const i=Object.assign(Object.assign({},qt),r);let o=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(i.upsert)});const a=i.metadata;"undefined"!=typeof Blob&&s instanceof Blob?(n=new FormData,n.append("cacheControl",i.cacheControl),a&&n.append("metadata",this.encodeMetadata(a)),n.append("",s)):"undefined"!=typeof FormData&&s instanceof FormData?(n=s,n.append("cacheControl",i.cacheControl),a&&n.append("metadata",this.encodeMetadata(a))):(n=s,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,a&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(a)))),(null==r?void 0:r.headers)&&(o=Object.assign(Object.assign({},o),r.headers));const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),h=yield("PUT"==e?Ut:Lt)(this.fetch,`${this.url}/object/${c}`,n,Object.assign({headers:o},(null==i?void 0:i.duplex)?{duplex:i.duplex}:{}));return{data:{path:l,id:h.Id,fullPath:h.Key},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(jt(n))return{data:null,error:n};throw n}})}upload(e,t,s){return Bt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,r){return Bt(this,void 0,void 0,function*(){const n=this._removeEmptyFolders(e),i=this._getFinalPath(n),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:qt.upsert},r),i=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!=typeof Blob&&s instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",s)):"undefined"!=typeof FormData&&s instanceof FormData?(e=s,e.append("cacheControl",t.cacheControl)):(e=s,i["cache-control"]=`max-age=${t.cacheControl}`,i["content-type"]=t.contentType);return{data:{path:n,fullPath:(yield Ut(this.fetch,o.toString(),e,{headers:i})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(jt(a))return{data:null,error:a};throw a}})}createSignedUploadUrl(e,t){return Bt(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const r=Object.assign({},this.headers);(null==t?void 0:t.upsert)&&(r["x-upsert"]="true");const n=yield Lt(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:r}),i=new URL(this.url+n.url),o=i.searchParams.get("token");if(!o)throw new kt("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:o},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(jt(s))return{data:null,error:s};throw s}})}update(e,t,s){return Bt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return Bt(this,void 0,void 0,function*(){try{return{data:yield Lt(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==s?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jt(r))return{data:null,error:r};throw r}})}copy(e,t,s){return Bt(this,void 0,void 0,function*(){try{return{data:{path:(yield Lt(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==s?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jt(r))return{data:null,error:r};throw r}})}createSignedUrl(e,t,s){return Bt(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),n=yield Lt(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},(null==s?void 0:s.transform)?{transform:s.transform}:{}),{headers:this.headers});const i=(null==s?void 0:s.download)?`&download=${!0===s.download?"":s.download}`:"";return n={signedUrl:encodeURI(`${this.url}${n.signedURL}${i}`)},{data:n,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jt(r))return{data:null,error:r};throw r}})}createSignedUrls(e,t,s){return Bt(this,void 0,void 0,function*(){try{const r=yield Lt(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),n=(null==s?void 0:s.download)?`&download=${!0===s.download?"":s.download}`:"";return{data:r.map(e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${n}`):null})),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jt(r))return{data:null,error:r};throw r}})}download(e,t){return Bt(this,void 0,void 0,function*(){const s=void 0!==(null==t?void 0:t.transform)?"render/image/authenticated":"object",r=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),n=r?`?${r}`:"";try{const t=this._getFinalPath(e),r=yield Rt(this.fetch,`${this.url}/${s}/${t}${n}`,{headers:this.headers,noResolveJson:!0});return{data:yield r.blob(),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(jt(i))return{data:null,error:i};throw i}})}info(e){return Bt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const e=yield Rt(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Pt(e),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(jt(s))return{data:null,error:s};throw s}})}exists(e){return Bt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield function(e,t,s,r){return Ct(this,void 0,void 0,function*(){return $t(e,"HEAD",t,Object.assign(Object.assign({},s),{noResolveJson:!0}),r)})}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(jt(s)&&s instanceof Tt){const e=s.originalError;if([400,404].includes(null==e?void 0:e.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,t){const s=this._getFinalPath(e),r=[],n=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==n&&r.push(n);const i=void 0!==(null==t?void 0:t.transform)?"render/image":"object",o=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==o&&r.push(o);let a=r.join("&");return""!==a&&(a=`?${a}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${s}${a}`)}}}remove(e){return Bt(this,void 0,void 0,function*(){try{return{data:yield Dt(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(jt(t))return{data:null,error:t};throw t}})}list(e,t,s){return Bt(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},zt),t),{prefix:e||""});return{data:yield Lt(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},s),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(jt(r))return{data:null,error:r};throw r}})}listV2(e,t){return Bt(this,void 0,void 0,function*(){try{const s=Object.assign({},e);return{data:yield Lt(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,s,{headers:this.headers},t),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(jt(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!=typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Wt={"X-Client-Info":"storage-js/2.12.1"};var Ft=function(e,t,s,r){return new(s||(s=Promise))(function(n,i){function o(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(o,a)}l((r=r.apply(e,t||[])).next())})};class Kt{constructor(e,t={},s,r){this.shouldThrowOnError=!1;const n=new URL(e);if(null==r?void 0:r.useNewHostname){/supabase\.(co|in|red)$/.test(n.hostname)&&!n.hostname.includes("storage.supabase.")&&(n.hostname=n.hostname.replace("supabase.","storage.supabase."))}this.url=n.href,this.headers=Object.assign(Object.assign({},Wt),t),this.fetch=Ot(s)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return Ft(this,void 0,void 0,function*(){try{return{data:yield Rt(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(jt(e))return{data:null,error:e};throw e}})}getBucket(e){return Ft(this,void 0,void 0,function*(){try{return{data:yield Rt(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(jt(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Ft(this,void 0,void 0,function*(){try{return{data:yield Lt(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(jt(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return Ft(this,void 0,void 0,function*(){try{return{data:yield Ut(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(jt(s))return{data:null,error:s};throw s}})}emptyBucket(e){return Ft(this,void 0,void 0,function*(){try{return{data:yield Lt(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(jt(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Ft(this,void 0,void 0,function*(){try{return{data:yield Dt(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(jt(t))return{data:null,error:t};throw t}})}}class Ht extends Kt{constructor(e,t={},s,r){super(e,t,s,r)}from(e){return new Mt(this.url,this.headers,e,this.fetch)}}let Jt="";Jt="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const Vt={headers:{"X-Client-Info":`supabase-js-${Jt}/2.57.4`}},Gt={schema:"public"},Yt={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Xt={};var Qt=function(e,t,s,r){return new(s||(s=Promise))(function(n,i){function o(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(o,a)}l((r=r.apply(e,t||[])).next())})};const Zt=(e,t,s)=>{const r=(e=>{let t;return t=e||("undefined"==typeof fetch?Z:fetch),(...e)=>t(...e)})(s),n="undefined"==typeof Headers?ee:Headers;return(s,i)=>Qt(void 0,void 0,void 0,function*(){var o;const a=null!==(o=yield t())&&void 0!==o?o:e;let l=new n(null==i?void 0:i.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${a}`),r(s,Object.assign(Object.assign({},i),{headers:l}))})};var es=function(e,t,s,r){return new(s||(s=Promise))(function(n,i){function o(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(o,a)}l((r=r.apply(e,t||[])).next())})};const ts="2.71.1",ss=3e4,rs=9e4,ns={"X-Client-Info":`gotrue-js/${ts}`},is="X-Supabase-Api-Version",os={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"},as=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class ls extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function cs(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class hs extends ls{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}class ds extends ls{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class us extends ls{constructor(e,t,s,r){super(e,s,r),this.name=t,this.status=s}}class ps extends us{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class fs extends us{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ms extends us{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class gs extends us{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class vs extends us{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class bs extends us{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function ys(e){return cs(e)&&"AuthRetryableFetchError"===e.name}class ws extends us{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}class _s extends us{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const xs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ks=" \t\n\r=".split(""),js=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<ks.length;t+=1)e[ks[t].charCodeAt(0)]=-2;for(let t=0;t<xs.length;t+=1)e[xs[t].charCodeAt(0)]=t;return e})();function Ss(e,t,s){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;s(xs[e]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;s(xs[e]),t.queuedBits-=6}}function Ts(e,t,s){const r=js[e];if(!(r>-1)){if(-2===r)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)s(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function Es(e){const t=[],s=e=>{t.push(String.fromCodePoint(e))},r={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},i=e=>{!function(e,t,s){if(0===t.utf8seq){if(e<=127)return void s(e);for(let s=1;s<6;s+=1)if(!(e>>7-s&1)){t.utf8seq=s;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&s(t.codepoint)}}(e,r,s)};for(let o=0;o<e.length;o+=1)Ts(e.charCodeAt(o),n,i);return t.join("")}function Os(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}t(e)}function Ps(e){const t=[],s={queue:0,queuedBits:0},r=e=>{t.push(e)};for(let n=0;n<e.length;n+=1)Ts(e.charCodeAt(n),s,r);return new Uint8Array(t)}function Cs(e){const t=[];return function(e,t){for(let s=0;s<e.length;s+=1){let r=e.charCodeAt(s);if(r>55295&&r<=56319){const t=1024*(r-55296)&65535;r=65536+(e.charCodeAt(s+1)-56320&65535|t),s+=1}Os(r,t)}}(e,e=>t.push(e)),new Uint8Array(t)}function Ns(e){const t=[],s={queue:0,queuedBits:0},r=e=>{t.push(e)};return e.forEach(e=>Ss(e,s,r)),Ss(null,s,r),t.join("")}const As=()=>"undefined"!=typeof window&&"undefined"!=typeof document,Is={tested:!1,writable:!1},$s=()=>{if(!As())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(t){return!1}if(Is.tested)return Is.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Is.tested=!0,Is.writable=!0}catch(t){Is.tested=!0,Is.writable=!1}return Is.writable};const Rs=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>A(async()=>{const{default:e}=await Promise.resolve().then(()=>re);return{default:e}},void 0).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},Ls=async(e,t,s)=>{await e.setItem(t,JSON.stringify(s))},Us=async(e,t)=>{const s=await e.getItem(t);if(!s)return null;try{return JSON.parse(s)}catch(r){return s}},Ds=async(e,t)=>{await e.removeItem(t)};class Bs{constructor(){this.promise=new Bs.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function zs(e){const t=e.split(".");if(3!==t.length)throw new _s("Invalid JWT structure");for(let s=0;s<t.length;s++)if(!as.test(t[s]))throw new _s("JWT not in base64url format");return{header:JSON.parse(Es(t[0])),payload:JSON.parse(Es(t[1])),signature:Ps(t[2]),raw:{header:t[0],payload:t[1]}}}function qs(e){return("0"+e.toString(16)).substr(-2)}async function Ms(e){if(!("undefined"!=typeof crypto&&void 0!==crypto.subtle&&"undefined"!=typeof TextEncoder))return e;const t=await async function(e){const t=(new TextEncoder).encode(e),s=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(s);return Array.from(r).map(e=>String.fromCharCode(e)).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ws(e,t,s=!1){const r=function(){const e=new Uint32Array(56);if("undefined"==typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let s="";for(let r=0;r<56;r++)s+=e.charAt(Math.floor(Math.random()*t));return s}return crypto.getRandomValues(e),Array.from(e,qs).join("")}();let n=r;s&&(n+="/PASSWORD_RECOVERY"),await Ls(e,`${t}-code-verifier`,n);const i=await Ms(r);return[i,r===i?"plain":"s256"]}Bs.promiseConstructor=Promise;const Fs=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;const Ks=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Hs(e){if(!Ks.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Js(){return new Proxy({},{get:(e,t)=>{if("__isUserNotAvailableProxy"===t)return!0;if("symbol"==typeof t){const e=t.toString();if("Symbol(Symbol.toPrimitive)"===e||"Symbol(Symbol.toStringTag)"===e||"Symbol(util.inspect.custom)"===e)return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Vs(e){return JSON.parse(JSON.stringify(e))}const Gs=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Ys=[502,503,504];async function Xs(e){var t,s;if(!("object"==typeof(s=e)&&null!==s&&"status"in s&&"ok"in s&&"json"in s&&"function"==typeof s.json))throw new bs(Gs(e),0);if(Ys.includes(e.status))throw new bs(Gs(e),e.status);let r,n;try{r=await e.json()}catch(o){throw new ds(Gs(o),o)}const i=function(e){const t=e.headers.get(is);if(!t)return null;if(!t.match(Fs))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(o){return null}}(e);if(i&&i.getTime()>=os.timestamp&&"object"==typeof r&&r&&"string"==typeof r.code?n=r.code:"object"==typeof r&&r&&"string"==typeof r.error_code&&(n=r.error_code),n){if("weak_password"===n)throw new ws(Gs(r),e.status,(null===(t=r.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===n)throw new ps}else if("object"==typeof r&&r&&"object"==typeof r.weak_password&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0))throw new ws(Gs(r),e.status,r.weak_password.reasons);throw new hs(Gs(r),e.status||500,n)}async function Qs(e,t,s,r){var n;const i=Object.assign({},null==r?void 0:r.headers);i[is]||(i[is]=os.name),(null==r?void 0:r.jwt)&&(i.Authorization=`Bearer ${r.jwt}`);const o=null!==(n=null==r?void 0:r.query)&&void 0!==n?n:{};(null==r?void 0:r.redirectTo)&&(o.redirect_to=r.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await async function(e,t,s,r,n,i){const o=((e,t,s,r)=>{const n={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),n.body=JSON.stringify(r),Object.assign(Object.assign({},n),s))})(t,r,n,i);let a;try{a=await e(s,Object.assign({},o))}catch(l){throw new bs(Gs(l),0)}a.ok||await Xs(a);if(null==r?void 0:r.noResolveJson)return a;try{return await a.json()}catch(l){await Xs(l)}}(e,t,s+a,{headers:i,noResolveJson:null==r?void 0:r.noResolveJson},{},null==r?void 0:r.body);return(null==r?void 0:r.xform)?null==r?void 0:r.xform(l):{data:Object.assign({},l),error:null}}function Zs(e){var t;let s=null;var r;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(s=Object.assign({},e),e.expires_at||(s.expires_at=(r=e.expires_in,Math.round(Date.now()/1e3)+r)));return{data:{session:s,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function er(e){const t=Zs(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function tr(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function sr(e){return{data:e,error:null}}function rr(e){const{action_link:t,email_otp:s,hashed_token:r,redirect_to:n,verification_type:i}=e,o=function(e,t){var s={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(s[r[n]]=e[r[n]])}return s}(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:s,hashed_token:r,redirect_to:n,verification_type:i},user:Object.assign({},o)},error:null}}function nr(e){return e}const ir=["global","local","others"];class or{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=Rs(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=ir[0]){if(ir.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ir.join(", ")}`);try{return await Qs(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(cs(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await Qs(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:tr})}catch(s){if(cs(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=function(e,t){var s={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(s[r[n]]=e[r[n]])}return s}(e,["options"]),r=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(r.new_email=null==s?void 0:s.newEmail,delete r.newEmail),await Qs(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:rr,redirectTo:null==t?void 0:t.redirectTo})}catch(t){if(cs(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Qs(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:tr})}catch(t){if(cs(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,r,n,i,o,a;try{const l={nextPage:null,lastPage:0,total:0},c=await Qs(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(s=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==s?s:"",per_page:null!==(n=null===(r=null==e?void 0:e.perPage)||void 0===r?void 0:r.toString())&&void 0!==n?n:""},xform:nr});if(c.error)throw c.error;const h=await c.json(),d=null!==(i=c.headers.get("x-total-count"))&&void 0!==i?i:0,u=null!==(a=null===(o=c.headers.get("link"))||void 0===o?void 0:o.split(","))&&void 0!==a?a:[];return u.length>0&&(u.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),s=JSON.parse(e.split(";")[1].split("=")[1]);l[`${s}Page`]=t}),l.total=parseInt(d)),{data:Object.assign(Object.assign({},h),l),error:null}}catch(l){if(cs(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){Hs(e);try{return await Qs(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:tr})}catch(t){if(cs(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Hs(e);try{return await Qs(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:tr})}catch(s){if(cs(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){Hs(e);try{return await Qs(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:tr})}catch(s){if(cs(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){Hs(e.userId);try{const{data:t,error:s}=await Qs(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:s}}catch(t){if(cs(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Hs(e.userId),Hs(e.id);try{return{data:await Qs(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(cs(t))return{data:null,error:t};throw t}}}function ar(e={}){return{getItem:t=>e[t]||null,setItem:(t,s)=>{e[t]=s},removeItem:t=>{delete e[t]}}}const lr=!!(globalThis&&$s()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class cr extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class hr extends cr{}async function dr(e,t,s){const r=new globalThis.AbortController;return t>0&&setTimeout(()=>{r.abort()},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async r=>{if(!r){if(0===t)throw new hr(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(lr)try{await globalThis.navigator.locks.query()}catch(n){}return await s()}try{return await s()}finally{}}))}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}}();const ur={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ns,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function pr(e,t,s){return await s()}const fr={};class mr{constructor(e){var t,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=mr.nextInstanceID,mr.nextInstanceID+=1,this.instanceID>0&&As();const r=Object.assign(Object.assign({},ur),e);if(this.logDebugMessages=!!r.debug,"function"==typeof r.debug&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new or({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=Rs(r.fetch),this.lock=r.lock||pr,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:As()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=dr:this.lock=pr,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(r.storage?this.storage=r.storage:$s()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=ar(this.memoryStorage)),r.userStorage&&(this.userStorage=r.userStorage)):(this.memoryStorage={},this.storage=ar(this.memoryStorage)),As()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(n){}null===(s=this.broadcastChannel)||void 0===s||s.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}get jwks(){var e,t;return null!==(t=null===(e=fr[this.storageKey])||void 0===e?void 0:e.jwks)&&void 0!==t?t:{keys:[]}}set jwks(e){fr[this.storageKey]=Object.assign(Object.assign({},fr[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return null!==(t=null===(e=fr[this.storageKey])||void 0===e?void 0:e.cachedAt)&&void 0!==t?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){fr[this.storageKey]=Object.assign(Object.assign({},fr[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${ts}) ${(new Date).toISOString()}`,...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{const t=function(e){const t={},s=new URL(e);if(s.hash&&"#"===s.hash[0])try{new URLSearchParams(s.hash.substring(1)).forEach((e,s)=>{t[s]=e})}catch(r){}return s.searchParams.forEach((e,s)=>{t[s]=e}),t}(window.location.href);let s="none";if(this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce"),As()&&this.detectSessionInUrl&&"none"!==s){const{data:r,error:n}=await this._getSessionFromURL(t,s);if(n){if(this._debug("#_initialize()","error detecting session from URL",n),function(e){return cs(e)&&"AuthImplicitGrantRedirectError"===e.name}(n)){const t=null===(e=n.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:n}}return await this._removeSession(),{error:n}}const{session:i,redirectType:o}=r;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{"recovery"===o?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return cs(t)?{error:t}:{error:new ds("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,r;try{const n=await Qs(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(s=null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==s?s:{},gotrue_meta_security:{captcha_token:null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.captchaToken}},xform:Zs}),{data:i,error:o}=n;if(o||!i)return{data:{user:null,session:null},error:o};const a=i.session,l=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:l,session:a},error:null}}catch(n){if(cs(n))return{data:{user:null,session:null},error:n};throw n}}async signUp(e){var t,s,r;try{let n;if("email"in e){const{email:s,password:r,options:i}=e;let o=null,a=null;"pkce"===this.flowType&&([o,a]=await Ws(this.storage,this.storageKey)),n=await Qs(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==i?void 0:i.emailRedirectTo,body:{email:s,password:r,data:null!==(t=null==i?void 0:i.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken},code_challenge:o,code_challenge_method:a},xform:Zs})}else{if(!("phone"in e))throw new ms("You must provide either an email or phone number and a password");{const{phone:t,password:i,options:o}=e;n=await Qs(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:i,data:null!==(s=null==o?void 0:o.data)&&void 0!==s?s:{},channel:null!==(r=null==o?void 0:o.channel)&&void 0!==r?r:"sms",gotrue_meta_security:{captcha_token:null==o?void 0:o.captchaToken}},xform:Zs})}}const{data:i,error:o}=n;if(o||!i)return{data:{user:null,session:null},error:o};const a=i.session,l=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:l,session:a},error:null}}catch(n){if(cs(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithPassword(e){try{let t;if("email"in e){const{email:s,password:r,options:n}=e;t=await Qs(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:r,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:er})}else{if(!("phone"in e))throw new ms("You must provide either an email or phone number and a password");{const{phone:s,password:r,options:n}=e;t=await Qs(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:r,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:er})}}const{data:s,error:r}=t;return r?{data:{user:null,session:null},error:r}:s&&s.session&&s.user?(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:r}):{data:{user:null,session:null},error:new fs}}catch(t){if(cs(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,r,n;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(s=e.options)||void 0===s?void 0:s.scopes,queryParams:null===(r=e.options)||void 0===r?void 0:r.queryParams,skipBrowserRedirect:null===(n=e.options)||void 0===n?void 0:n.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if("solana"===t)return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,s,r,n,i,o,a,l,c,h,d,u;let p,f;if("message"in e)p=e.message,f=e.signature;else{const{chain:d,wallet:u,statement:m,options:g}=e;let v;if(As())if("object"==typeof u)v=u;else{const e=window;if(!("solana"in e)||"object"!=typeof e.solana||!("signIn"in e.solana&&"function"==typeof e.solana.signIn||"signMessage"in e.solana&&"function"==typeof e.solana.signMessage))throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.");v=e.solana}else{if("object"!=typeof u||!(null==g?void 0:g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");v=u}const b=new URL(null!==(t=null==g?void 0:g.url)&&void 0!==t?t:window.location.href);if("signIn"in v&&v.signIn){const e=await v.signIn(Object.assign(Object.assign(Object.assign({issuedAt:(new Date).toISOString()},null==g?void 0:g.signInWithSolana),{version:"1",domain:b.host,uri:b.href}),m?{statement:m}:null));let t;if(Array.isArray(e)&&e[0]&&"object"==typeof e[0])t=e[0];else{if(!(e&&"object"==typeof e&&"signedMessage"in e&&"signature"in e))throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");t=e}if(!("signedMessage"in t&&"signature"in t&&("string"==typeof t.signedMessage||t.signedMessage instanceof Uint8Array)&&t.signature instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields");p="string"==typeof t.signedMessage?t.signedMessage:(new TextDecoder).decode(t.signedMessage),f=t.signature}else{if(!("signMessage"in v&&"function"==typeof v.signMessage&&"publicKey"in v&&"object"==typeof v&&v.publicKey&&"toBase58"in v.publicKey&&"function"==typeof v.publicKey.toBase58))throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${b.host} wants you to sign in with your Solana account:`,v.publicKey.toBase58(),...m?["",m,""]:[""],"Version: 1",`URI: ${b.href}`,`Issued At: ${null!==(r=null===(s=null==g?void 0:g.signInWithSolana)||void 0===s?void 0:s.issuedAt)&&void 0!==r?r:(new Date).toISOString()}`,...(null===(n=null==g?void 0:g.signInWithSolana)||void 0===n?void 0:n.notBefore)?[`Not Before: ${g.signInWithSolana.notBefore}`]:[],...(null===(i=null==g?void 0:g.signInWithSolana)||void 0===i?void 0:i.expirationTime)?[`Expiration Time: ${g.signInWithSolana.expirationTime}`]:[],...(null===(o=null==g?void 0:g.signInWithSolana)||void 0===o?void 0:o.chainId)?[`Chain ID: ${g.signInWithSolana.chainId}`]:[],...(null===(a=null==g?void 0:g.signInWithSolana)||void 0===a?void 0:a.nonce)?[`Nonce: ${g.signInWithSolana.nonce}`]:[],...(null===(l=null==g?void 0:g.signInWithSolana)||void 0===l?void 0:l.requestId)?[`Request ID: ${g.signInWithSolana.requestId}`]:[],...(null===(h=null===(c=null==g?void 0:g.signInWithSolana)||void 0===c?void 0:c.resources)||void 0===h?void 0:h.length)?["Resources",...g.signInWithSolana.resources.map(e=>`- ${e}`)]:[]].join("\n");const e=await v.signMessage((new TextEncoder).encode(p),"utf8");if(!(e&&e instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");f=e}}try{const{data:t,error:s}=await Qs(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:Ns(f)},(null===(d=e.options)||void 0===d?void 0:d.captchaToken)?{gotrue_meta_security:{captcha_token:null===(u=e.options)||void 0===u?void 0:u.captchaToken}}:null),xform:Zs});if(s)throw s;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign({},t),error:s}):{data:{user:null,session:null},error:new fs}}catch(m){if(cs(m))return{data:{user:null,session:null},error:m};throw m}}async _exchangeCodeForSession(e){const t=await Us(this.storage,`${this.storageKey}-code-verifier`),[s,r]=(null!=t?t:"").split("/");try{const{data:t,error:n}=await Qs(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Zs});if(await Ds(this.storage,`${this.storageKey}-code-verifier`),n)throw n;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!=r?r:null}),error:n}):{data:{user:null,session:null,redirectType:null},error:new fs}}catch(n){if(cs(n))return{data:{user:null,session:null,redirectType:null},error:n};throw n}}async signInWithIdToken(e){try{const{options:t,provider:s,token:r,access_token:n,nonce:i}=e,o=await Qs(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:r,access_token:n,nonce:i,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:Zs}),{data:a,error:l}=o;return l?{data:{user:null,session:null},error:l}:a&&a.session&&a.user?(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:a,error:l}):{data:{user:null,session:null},error:new fs}}catch(t){if(cs(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,r,n,i;try{if("email"in e){const{email:r,options:n}=e;let i=null,o=null;"pkce"===this.flowType&&([i,o]=await Ws(this.storage,this.storageKey));const{error:a}=await Qs(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:r,data:null!==(t=null==n?void 0:n.data)&&void 0!==t?t:{},create_user:null===(s=null==n?void 0:n.shouldCreateUser)||void 0===s||s,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken},code_challenge:i,code_challenge_method:o},redirectTo:null==n?void 0:n.emailRedirectTo});return{data:{user:null,session:null},error:a}}if("phone"in e){const{phone:t,options:s}=e,{data:o,error:a}=await Qs(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(r=null==s?void 0:s.data)&&void 0!==r?r:{},create_user:null===(n=null==s?void 0:s.shouldCreateUser)||void 0===n||n,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken},channel:null!==(i=null==s?void 0:s.channel)&&void 0!==i?i:"sms"}});return{data:{user:null,session:null,messageId:null==o?void 0:o.message_id},error:a}}throw new ms("You must provide either an email or phone number.")}catch(o){if(cs(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,s;try{let r,n;"options"in e&&(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo,n=null===(s=e.options)||void 0===s?void 0:s.captchaToken);const{data:i,error:o}=await Qs(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:n}}),redirectTo:r,xform:Zs});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const a=i.session,l=i.user;return(null==a?void 0:a.access_token)&&(await this._saveSession(a),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",a)),{data:{user:l,session:a},error:null}}catch(r){if(cs(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var t,s,r;try{let n=null,i=null;return"pkce"===this.flowType&&([n,i]=await Ws(this.storage,this.storageKey)),await Qs(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(s=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==s?s:void 0}),(null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:n,code_challenge_method:i}),headers:this.headers,xform:sr})}catch(n){if(cs(n))return{data:null,error:n};throw n}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new ps;const{error:r}=await Qs(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}})}catch(e){if(cs(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:r,options:n}=e,{error:i}=await Qs(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:r,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},redirectTo:null==n?void 0:n.emailRedirectTo});return{data:{user:null,session:null},error:i}}if("phone"in e){const{phone:s,type:r,options:n}=e,{data:i,error:o}=await Qs(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:r,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}}});return{data:{user:null,session:null,messageId:null==i?void 0:i.message_id},error:o}}throw new ms("You must provide either an email or phone number and a type")}catch(t){if(cs(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch(e){}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(t){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await Us(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=!!e.expires_at&&1e3*e.expires_at-Date.now()<rs;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const t=await Us(this.userStorage,this.storageKey+"-user");(null==t?void 0:t.user)?e.user=t.user:e.user=Js()}if(this.storage.isServer&&e.user){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,s,r)=>(t||"user"!==s||(t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,s,r))})}return{data:{session:e},error:null}}const{session:r,error:n}=await this._callRefreshToken(e.refresh_token);return n?{data:{session:null},error:n}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;return await this._acquireLock(-1,async()=>await this._getUser())}async _getUser(e){try{return e?await Qs(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:tr}):await this._useSession(async e=>{var t,s,r;const{data:n,error:i}=e;if(i)throw i;return(null===(t=n.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await Qs(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(r=null===(s=n.session)||void 0===s?void 0:s.access_token)&&void 0!==r?r:void 0,xform:tr}):{data:{user:null},error:new ps}})}catch(t){if(cs(t))return function(e){return cs(e)&&"AuthSessionMissingError"===e.name}(t)&&(await this._removeSession(),await Ds(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:r,error:n}=s;if(n)throw n;if(!r.session)throw new ps;const i=r.session;let o=null,a=null;"pkce"===this.flowType&&null!=e.email&&([o,a]=await Ws(this.storage,this.storageKey));const{data:l,error:c}=await Qs(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:a}),jwt:i.access_token,xform:tr});if(c)throw c;return i.user=l.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(s){if(cs(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ps;const t=Date.now()/1e3;let s=t,r=!0,n=null;const{payload:i}=zs(e.access_token);if(i.exp&&(s=i.exp,r=s<=t),r){const{session:t,error:s}=await this._callRefreshToken(e.refresh_token);if(s)return{data:{user:null,session:null},error:s};if(!t)return{data:{user:null,session:null},error:null};n=t}else{const{data:r,error:i}=await this._getUser(e.access_token);if(i)throw i;n={access_token:e.access_token,refresh_token:e.refresh_token,user:r.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)}return{data:{user:n.user,session:n},error:null}}catch(t){if(cs(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:r,error:n}=t;if(n)throw n;e=null!==(s=r.session)&&void 0!==s?s:void 0}if(!(null==e?void 0:e.refresh_token))throw new ps;const{session:r,error:n}=await this._callRefreshToken(e.refresh_token);return n?{data:{user:null,session:null},error:n}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(cs(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!As())throw new gs("No browser detected.");if(e.error||e.error_description||e.error_code)throw new gs(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new vs("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new gs("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new vs("No code detected.");const{data:t,error:s}=await this._exchangeCodeForSession(e.code);if(s)throw s;const r=new URL(window.location.href);return r.searchParams.delete("code"),window.history.replaceState(window.history.state,"",r.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:r,access_token:n,refresh_token:i,expires_in:o,expires_at:a,token_type:l}=e;if(!(n&&o&&i&&l))throw new gs("No session defined in URL");const c=Math.round(Date.now()/1e3),h=parseInt(o);let d=c+h;a&&(d=parseInt(a));const{data:u,error:p}=await this._getUser(n);if(p)throw p;const f={provider_token:s,provider_refresh_token:r,access_token:n,expires_in:h,expires_at:d,refresh_token:i,token_type:l,user:u.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:f,redirectType:e.type},error:null}}catch(s){if(cs(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Us(this.storage,`${this.storageKey}-code-verifier`);return!(!e.code||!t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:r,error:n}=t;if(n)return{error:n};const i=null===(s=r.session)||void 0===s?void 0:s.access_token;if(i){const{error:t}=await this.admin.signOut(i,e);if(t&&(!function(e){return cs(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await Ds(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,r;try{const{data:{session:r},error:n}=t;if(n)throw n;await(null===(s=this.stateChangeEmitters.get(e))||void 0===s?void 0:s.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",e,"session",r)}catch(n){await(null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",n)}})}async resetPasswordForEmail(e,t={}){let s=null,r=null;"pkce"===this.flowType&&([s,r]=await Ws(this.storage,this.storageKey,!0));try{return await Qs(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(n){if(cs(n))return{data:null,error:n};throw n}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(t){if(cs(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:r}=await this._useSession(async t=>{var s,r,n,i,o;const{data:a,error:l}=t;if(l)throw l;const c=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(s=e.options)||void 0===s?void 0:s.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(n=e.options)||void 0===n?void 0:n.queryParams,skipBrowserRedirect:!0});return await Qs(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(o=null===(i=a.session)||void 0===i?void 0:i.access_token)&&void 0!==o?o:void 0})});if(r)throw r;return As()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null==s?void 0:s.url),{data:{provider:e.provider,url:null==s?void 0:s.url},error:null}}catch(s){if(cs(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,r;const{data:n,error:i}=t;if(i)throw i;return await Qs(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(r=null===(s=n.session)||void 0===s?void 0:s.access_token)&&void 0!==r?r:void 0})})}catch(t){if(cs(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await(s=async s=>(s>0&&await async function(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await Qs(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Zs})),r=(e,t)=>{const s=200*Math.pow(2,e);return t&&ys(t)&&Date.now()+s-n<ss},new Promise((e,t)=>{(async()=>{for(let i=0;i<1/0;i++)try{const t=await s(i);if(!r(i,null,t))return void e(t)}catch(n){if(!r(i,n))return void t(n)}})()}))}catch(n){if(this._debug(t,"error",n),cs(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(t,"end")}var s,r}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),As()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,t;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const n=await Us(this.storage,this.storageKey);if(n&&this.userStorage){let t=await Us(this.userStorage,this.storageKey+"-user");this.storage.isServer||!Object.is(this.storage,this.userStorage)||t||(t={user:n.user},await Ls(this.userStorage,this.storageKey+"-user",t)),n.user=null!==(e=null==t?void 0:t.user)&&void 0!==e?e:Js()}else if(n&&!n.user&&!n.user){const e=await Us(this.storage,this.storageKey+"-user");e&&(null==e?void 0:e.user)?(n.user=e.user,await Ds(this.storage,this.storageKey+"-user"),await Ls(this.storage,this.storageKey,n)):n.user=Js()}if(this._debug(s,"session from storage",n),!this._isValidSession(n))return this._debug(s,"session is not valid"),void(null!==n&&await this._removeSession());const i=1e3*(null!==(t=n.expires_at)&&void 0!==t?t:1/0)-Date.now()<rs;if(this._debug(s,`session has${i?"":" not"} expired with margin of 90000s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:e}=await this._callRefreshToken(n.refresh_token);e&&(ys(e)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else if(n.user&&!0===n.user.__isUserNotAvailableProxy)try{const{data:e,error:t}=await this._getUser(n.access_token);!t&&(null==e?void 0:e.user)?(n.user=e.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(r){this._debug(s,"error getting user data, skipping SIGNED_IN notification",r)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){return void this._debug(s,"error",n)}finally{this._debug(s,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new ps;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new Bs;const{data:t,error:s}=await this._refreshAccessToken(e);if(s)throw s;if(!t.session)throw new ps;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const r={session:t.session,error:null};return this.refreshingDeferred.resolve(r),r}catch(n){if(this._debug(r,"error",n),cs(n)){const e={session:null,error:n};return ys(n)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(s=this.refreshingDeferred)||void 0===s||s.reject(n),n}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t,s=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const r=[],n=Array.from(this.stateChangeEmitters.values()).map(async s=>{try{await s.callback(e,t)}catch(n){r.push(n)}});if(await Promise.all(n),r.length>0){for(let e=0;e<r.length;e+=1);throw r[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),s=t.user&&!0===t.user.__isUserNotAvailableProxy;if(this.userStorage){!s&&t.user&&await Ls(this.userStorage,this.storageKey+"-user",{user:t.user});const e=Object.assign({},t);delete e.user;const r=Vs(e);await Ls(this.storage,this.storageKey,r)}else{const e=Vs(t);await Ls(this.storage,this.storageKey,e)}}async _removeSession(){this._debug("#_removeSession()"),await Ds(this.storage,this.storageKey),await Ds(this.storage,this.storageKey+"-code-verifier"),await Ds(this.storage,this.storageKey+"-user"),this.userStorage&&await Ds(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&As()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ss);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async e=>{const{data:{session:s}}=e;if(!s||!s.refresh_token||!s.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const r=Math.floor((1e3*s.expires_at-t)/ss);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),r<=3&&await this._callRefreshToken(s.refresh_token)})}catch(e){}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(!(e.isAcquireTimeout||e instanceof cr))throw e;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!As()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const r=[`provider=${encodeURIComponent(t)}`];if((null==s?void 0:s.redirectTo)&&r.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),(null==s?void 0:s.scopes)&&r.push(`scopes=${encodeURIComponent(s.scopes)}`),"pkce"===this.flowType){const[e,t]=await Ws(this.storage,this.storageKey),s=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});r.push(s.toString())}if(null==s?void 0:s.queryParams){const e=new URLSearchParams(s.queryParams);r.push(e.toString())}return(null==s?void 0:s.skipBrowserRedirect)&&r.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:r,error:n}=t;return n?{data:null,error:n}:await Qs(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token})})}catch(t){if(cs(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,r;const{data:n,error:i}=t;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:a,error:l}=await Qs(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:null===(s=null==n?void 0:n.session)||void 0===s?void 0:s.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&(null===(r=null==a?void 0:a.totp)||void 0===r?void 0:r.qr_code)&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),{data:a,error:null})})}catch(t){if(cs(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:r,error:n}=t;if(n)return{data:null,error:n};const{data:i,error:o}=await Qs(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})})}catch(t){if(cs(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:r,error:n}=t;return n?{data:null,error:n}:await Qs(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token})})}catch(t){if(cs(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=(null==e?void 0:e.factors)||[],r=s.filter(e=>"totp"===e.factor_type&&"verified"===e.status),n=s.filter(e=>"phone"===e.factor_type&&"verified"===e.status);return{data:{all:s,totp:r,phone:n},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,s;const{data:{session:r},error:n}=e;if(n)return{data:null,error:n};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=zs(r.access_token);let o=null;i.aal&&(o=i.aal);let a=o;(null!==(s=null===(t=r.user.factors)||void 0===t?void 0:t.filter(e=>"verified"===e.status))&&void 0!==s?s:[]).length>0&&(a="aal2");return{data:{currentLevel:o,nextLevel:a,currentAuthenticationMethods:i.amr||[]},error:null}}))}async fetchJwk(e,t={keys:[]}){let s=t.keys.find(t=>t.kid===e);if(s)return s;const r=Date.now();if(s=this.jwks.keys.find(t=>t.kid===e),s&&this.jwks_cached_at+6e5>r)return s;const{data:n,error:i}=await Qs(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return n.keys&&0!==n.keys.length?(this.jwks=n,this.jwks_cached_at=r,s=n.keys.find(t=>t.kid===e),s||null):null}async getClaims(e,t={}){try{let s=e;if(!s){const{data:e,error:t}=await this.getSession();if(t||!e.session)return{data:null,error:t};s=e.session.access_token}const{header:r,payload:n,signature:i,raw:{header:o,payload:a}}=zs(s);(null==t?void 0:t.allowExpired)||function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(n.exp);const l=r.alg&&!r.alg.startsWith("HS")&&r.kid&&"crypto"in globalThis&&"subtle"in globalThis.crypto?await this.fetchJwk(r.kid,(null==t?void 0:t.keys)?{keys:t.keys}:null==t?void 0:t.jwks):null;if(!l){const{error:e}=await this.getUser(s);if(e)throw e;return{data:{claims:n,header:r,signature:i},error:null}}const c=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(r.alg),h=await crypto.subtle.importKey("jwk",l,c,!0,["verify"]);if(!(await crypto.subtle.verify(c,h,i,Cs(`${o}.${a}`))))throw new _s("Invalid JWT signature");return{data:{claims:n,header:r,signature:i},error:null}}catch(s){if(cs(s))return{data:null,error:s};throw s}}}mr.nextInstanceID=0;const gr=mr;class vr extends gr{constructor(e){super(e)}}var br=function(e,t,s,r){return new(s||(s=Promise))(function(n,i){function o(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(o,a)}l((r=r.apply(e,t||[])).next())})};class yr{constructor(e,t,s){var r,n,i;this.supabaseUrl=e,this.supabaseKey=t;const o=function(e){const t=null==e?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL((s=t).endsWith("/")?s:s+"/")}catch(r){throw Error("Invalid supabaseUrl: Provided URL is malformed.")}var s}(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const a=`sb-${o.hostname.split(".")[0]}-auth-token`,l=function(e,t){var s,r;const{db:n,auth:i,realtime:o,global:a}=e,{db:l,auth:c,realtime:h,global:d}=t,u={db:Object.assign(Object.assign({},l),n),auth:Object.assign(Object.assign({},c),i),realtime:Object.assign(Object.assign({},h),o),storage:{},global:Object.assign(Object.assign(Object.assign({},d),a),{headers:Object.assign(Object.assign({},null!==(s=null==d?void 0:d.headers)&&void 0!==s?s:{}),null!==(r=null==a?void 0:a.headers)&&void 0!==r?r:{})}),accessToken:()=>es(this,void 0,void 0,function*(){return""})};return e.accessToken?u.accessToken=e.accessToken:delete u.accessToken,u}(null!=s?s:{},{db:Gt,realtime:Xt,auth:Object.assign(Object.assign({},Yt),{storageKey:a}),global:Vt});this.storageKey=null!==(r=l.auth.storageKey)&&void 0!==r?r:"",this.headers=null!==(n=l.global.headers)&&void 0!==n?n:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(i=l.auth)&&void 0!==i?i:{},this.headers,l.global.fetch),this.fetch=Zt(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.rest=new Pe(new URL("rest/v1",o).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),this.storage=new Ht(this.storageUrl.href,this.headers,this.fetch,null==s?void 0:s.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new F(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return br(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return null!==(t=null===(e=s.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,userStorage:n,storageKey:i,flowType:o,lock:a,debug:l},c,h){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new vr({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),c),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,userStorage:n,flowType:o,lock:a,debug:l,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(e=>"authorization"===e.toLowerCase())})}_initRealtimeClient(e){return new xt(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,s){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===s?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=s}}!function(){if("undefined"!=typeof window)return!1;if("undefined"==typeof process)return!1;const e=process.version;if(null==e)return!1;const t=e.match(/^v(\d+)\./);!!t&&parseInt(t[1],10)}();const wr=new yr("https://ciawsbarwhhebghhyjub.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNpYXdzYmFyd2hoZWJnaGh5anViIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE5NTI1MTYsImV4cCI6MjA3NzUyODUxNn0.XQIlffM2nzb_qQpe9BD7P55NccPEHr9XwOE4od6U3B8",{auth:{persistSession:!0}});const _r=async(e,t)=>{try{const s=e.name.split(".").pop()||"jpg",r=`${t}/${Date.now()}-${Math.random().toString(36).slice(2)}.${s}`,{data:n,error:i}=await wr.storage.from("media").upload(r,e,{upsert:!0});if(i||!n)throw i;const{data:o}=wr.storage.from("media").getPublicUrl(n.path);return o.publicUrl}catch(s){return null}},xr=()=>{const[t,s]=e.useState({from_name:"",from_email:"",message_type:"general",subject:"",message:"",is_anonymous:!1}),[r,n]=e.useState(!1),[d,u]=e.useState(!1),p=[{value:"prayer_request",label:"Prayer Request",icon:a,color:"pink"},{value:"testimony",label:"Testimony",icon:l,color:"green"},{value:"song_request",label:"Song Request",icon:c,color:"purple"},{value:"booking_inquiry",label:"Booking Inquiry",icon:h,color:"blue"},{value:"general",label:"General Message",icon:l,color:"gray"}];return d?P.jsx("div",{className:"max-w-2xl mx-auto p-4 md:p-6 text-center",children:P.jsxs("div",{className:"bg-purple-500/20 border border-purple-500/30 rounded-xl md:rounded-2xl p-6 md:p-8 backdrop-blur-xl",children:[P.jsx(i,{size:48,className:"mx-auto mb-3 md:mb-4 text-purple-400 md:w-16 md:h-16"}),P.jsx("h2",{className:"text-xl md:text-2xl font-bold text-white mb-2",children:"Message Sent!"}),P.jsx("p",{className:"text-sm md:text-base text-purple-200",children:"Thank you for reaching out. We'll get back to you soon!"})]})}):P.jsx("div",{className:"max-w-2xl mx-auto p-3 md:p-6",children:P.jsxs("div",{className:"bg-black/80 backdrop-blur-xl rounded-xl md:rounded-2xl shadow-xl p-4 md:p-6 border border-purple-500/30",children:[P.jsxs("div",{className:"text-center mb-6 md:mb-8",children:[P.jsx("h2",{className:"text-xl md:text-2xl lg:text-3xl font-black bg-gradient-to-r from-purple-400 to-purple-600 bg-clip-text text-transparent mb-2",children:"Send a Message"}),P.jsx("p",{className:"text-xs md:text-sm text-purple-200",children:"Share your prayer request, testimony, or get in touch with Esther Reign"})]}),P.jsxs("form",{onSubmit:async e=>{e.preventDefault(),n(!0);try{const{error:e}=await wr.from("fan_messages").insert([{...t,status:"unread",is_prayed_for:!1,is_featured:!1}]);if(e)throw e;u(!0),s({from_name:"",from_email:"",message_type:"general",subject:"",message:"",is_anonymous:!1}),setTimeout(()=>u(!1),5e3)}catch(r){alert("Failed to send message. Please try again.")}n(!1)},className:"space-y-4 md:space-y-5",children:[P.jsxs("div",{children:[P.jsx("label",{className:"block text-xs md:text-sm font-semibold text-purple-200 mb-2 md:mb-3",children:"What would you like to share? *"}),P.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 md:gap-3",children:p.map(e=>{const r=e.icon;return P.jsxs("button",{type:"button",onClick:()=>s({...t,message_type:e.value}),className:"p-2.5 md:p-3 rounded-lg md:rounded-xl border transition-all "+(t.message_type===e.value?"border-purple-500 bg-purple-500/20":"border-purple-500/20 hover:border-purple-500/40 bg-purple-500/5"),children:[P.jsx(r,{size:18,className:"mx-auto mb-1 md:mb-1.5 md:w-5 md:h-5 "+(t.message_type===e.value?"text-purple-300":"text-purple-400")}),P.jsx("p",{className:"text-[10px] md:text-xs font-medium "+(t.message_type===e.value?"text-white":"text-purple-200"),children:e.label})]},e.value)})})]}),P.jsxs("div",{children:[P.jsxs("label",{className:"block text-xs md:text-sm font-semibold text-purple-200 mb-1.5 md:mb-2",children:["Your Name ",!t.is_anonymous&&"*"]}),P.jsx("input",{type:"text",value:t.from_name,onChange:e=>s({...t,from_name:e.target.value}),disabled:t.is_anonymous,required:!t.is_anonymous,className:"w-full px-3 py-2 md:px-4 md:py-2.5 text-sm md:text-base bg-purple-500/10 text-white border border-purple-500/30 rounded-lg md:rounded-xl focus:border-purple-500 focus:outline-none transition-colors disabled:bg-gray-100 disabled:text-gray-500",placeholder:"Enter your name"}),P.jsxs("label",{className:"flex items-center gap-1.5 md:gap-2 mt-1.5 md:mt-2",children:[P.jsx("input",{type:"checkbox",checked:t.is_anonymous,onChange:e=>s({...t,is_anonymous:e.target.checked,from_name:e.target.checked?"Anonymous":""}),className:"rounded w-3.5 h-3.5 md:w-4 md:h-4"}),P.jsx("span",{className:"text-xs md:text-sm text-purple-200",children:"Send anonymously"})]})]}),P.jsxs("div",{children:[P.jsx("label",{className:"block text-xs md:text-sm font-semibold text-purple-200 mb-1.5 md:mb-2",children:"Email (optional)"}),P.jsx("input",{type:"email",value:t.from_email,onChange:e=>s({...t,from_email:e.target.value}),className:"w-full px-3 py-2 md:px-4 md:py-2.5 text-sm md:text-base bg-purple-500/10 text-white border border-purple-500/30 rounded-lg md:rounded-xl focus:border-purple-500 focus:outline-none transition-colors",placeholder:"your@email.com"}),P.jsx("p",{className:"text-[10px] md:text-xs text-purple-300 mt-1",children:"We'll only use this to respond to you"})]}),P.jsxs("div",{children:[P.jsx("label",{className:"block text-xs md:text-sm font-semibold text-purple-200 mb-1.5 md:mb-2",children:"Subject (optional)"}),P.jsx("input",{type:"text",value:t.subject,onChange:e=>s({...t,subject:e.target.value}),className:"w-full px-3 py-2 md:px-4 md:py-2.5 text-sm md:text-base bg-purple-500/10 text-white border border-purple-500/30 rounded-lg md:rounded-xl focus:border-purple-500 focus:outline-none transition-colors",placeholder:"Brief subject line"})]}),P.jsxs("div",{children:[P.jsx("label",{className:"block text-xs md:text-sm font-semibold text-purple-200 mb-1.5 md:mb-2",children:"Your Message *"}),P.jsx("textarea",{value:t.message,onChange:e=>s({...t,message:e.target.value}),required:!0,rows:5,className:"w-full px-3 py-2 md:px-4 md:py-2.5 text-sm md:text-base bg-purple-500/10 text-white border border-purple-500/30 rounded-lg md:rounded-xl focus:border-purple-500 focus:outline-none transition-colors resize-none",placeholder:"Share your message, prayer request, testimony, or inquiry..."})]}),P.jsxs("button",{type:"submit",disabled:r||!t.message.trim(),className:"w-full flex items-center justify-center gap-2 px-5 py-3 md:px-6 md:py-3.5 text-sm md:text-base bg-gradient-to-r from-purple-600 to-purple-700 text-white rounded-lg md:rounded-xl font-semibold hover:from-purple-700 hover:to-purple-800 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-xl hover:shadow-purple-500/50",children:[P.jsx(o,{size:16,className:"md:w-5 md:h-5"}),r?"Sending...":"Send Message"]})]})]})})},kr=e.lazy(()=>A(()=>import("./AdminPanel-tt10-kwz.js"),__vite__mapDeps([0,1,2,3]))),jr=()=>{var t,s,r,n,i,o,a,l,c,h,y,w;const[_,x]=e.useState(!1),[k,j]=e.useState("home"),[S,T]=e.useState(!0),[E,O]=e.useState(!1),[C,N]=e.useState([]),[U,D]=e.useState(null),[B,z]=e.useState(null),[q,M]=e.useState(0),[W,F]=e.useState(0);e.useEffect(()=>{K(),setTimeout(()=>T(!1),400),A(async()=>{const{subscribeToVideos:e,subscribeToSettings:t,trackVisit:s}=await import("./supabaseData-PmD0rX_k.js");return{subscribeToVideos:e,subscribeToSettings:t,trackVisit:s}},__vite__mapDeps([3,1,2])).then(({subscribeToVideos:e,subscribeToSettings:t,trackVisit:s})=>{s();const r=e(e=>{N(e.filter(e=>"completed"===e.status))}),n=t(e=>{D(e)});return()=>{r(),n()}})},[]);const K=async()=>{const{getCompletedVideos:e,getSettings:t}=await A(async()=>{const{getCompletedVideos:e,getSettings:t}=await import("./supabaseData-PmD0rX_k.js");return{getCompletedVideos:e,getSettings:t}},__vite__mapDeps([3,1,2])),[s,r]=await Promise.all([e(),t()]);N(s),D(r)},H=e=>{if(!e)return"";if(e.includes("cloudinary.com"))return e.includes("/upload/")?e.replace("/upload/","/upload/so_0,w_640,h_360,c_fill,f_jpg/"):e.includes("/video/")?e.replace("/video/","/image/").replace(/\.(mp4|mov|avi|webm|mkv)$/i,".jpg"):e.replace("/upload/","/upload/so_0,f_jpg/");let t="";const s=e.match(/[?&]v=([^&]+)/);s&&(t=s[1]);const r=e.match(/youtu\.be\/([^?]+)/);r&&(t=r[1]);const n=e.match(/embed\/([^?]+)/);return n&&(t=n[1]),t?`https://img.youtube.com/vi/${t}/maxresdefault.jpg`:""};e.useEffect(()=>{const e=()=>{const e=["home","about","videos","contact"].find(e=>{const t=document.getElementById(e);if(t){const e=t.getBoundingClientRect();return e.top<=100&&e.bottom>=100}return!1});e&&j(e)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]);const J=e=>{const t=document.getElementById(e);t&&t.scrollIntoView({behavior:"smooth"}),x(!1)};return e.useEffect(()=>{"#admin"===window.location.hash&&O(!0)},[]),E?P.jsx(e.Suspense,{fallback:P.jsx(R,{}),children:P.jsx(kr,{onClose:()=>{O(!1),window.location.hash="",K()}})}):S?P.jsx(R,{}):P.jsxs("div",{className:"bg-black text-white min-h-screen relative overflow-hidden",children:[P.jsx(L,{}),P.jsxs("nav",{className:"fixed top-0 w-full backdrop-blur-xl bg-black/90 border-b border-purple-500/30 z-40",children:[P.jsx("div",{className:"container mx-auto px-4 md:px-6 lg:px-12",children:P.jsxs("div",{className:"flex justify-between items-center h-16 md:h-20",children:[P.jsxs("div",{className:"flex items-center gap-2 md:gap-4 flex-shrink-0 cursor-pointer",onClick:()=>{const e=Date.now();if(e-W<1e3){const e=q+1;M(e),e>=3&&(O(!0),M(0),window.location.hash="#admin")}else M(1);F(e)},title:"Triple tap for admin access",children:[P.jsx("img",{src:"https://res.cloudinary.com/dtynqpjye/image/upload/v1761948158/ESTHER-REIGN-LOGO.-Photoroom_nj506d.png",alt:"Esther Reign Logo",className:"h-12 md:h-16 lg:h-20 w-auto",loading:"eager"}),P.jsx("span",{className:"text-[10px] sm:text-xs md:text-base lg:text-lg font-bold text-purple-300 whitespace-nowrap",children:"@officialEstherReign"})]}),P.jsx("div",{className:"hidden md:flex items-center space-x-6 lg:space-x-8",children:[{id:"home",label:"Home"},{id:"about",label:"About"},{id:"videos",label:"Videos"},{id:"contact",label:"Contact"}].map(e=>P.jsxs("button",{onClick:()=>J(e.id),className:"text-sm font-medium transition-all relative group "+(k===e.id?"text-purple-300":"text-gray-300 hover:text-white"),children:[e.label,P.jsx("span",{className:"absolute -bottom-1 left-0 h-0.5 bg-gradient-to-r from-purple-500 to-purple-600 transition-all "+(k===e.id?"w-full":"w-0 group-hover:w-full")})]},e.id))}),P.jsx("button",{className:"md:hidden text-white",onClick:()=>x(!_),children:_?P.jsx(d,{size:28}):P.jsx(u,{size:28})})]})}),_&&P.jsx("div",{className:"md:hidden backdrop-blur-xl bg-black/95 border-t border-purple-500/30",children:P.jsx("nav",{className:"container mx-auto px-6 py-6 space-y-4",children:[{id:"home",label:"Home"},{id:"about",label:"About"},{id:"videos",label:"Videos"},{id:"contact",label:"Contact"}].map(e=>P.jsx("button",{onClick:()=>J(e.id),className:"block w-full text-left py-2 text-gray-300 hover:text-purple-300 transition-colors",children:e.label},e.id))})})]}),P.jsx("section",{id:"home",className:"min-h-screen flex items-center relative overflow-hidden pt-16 md:pt-20 bg-black",children:P.jsx("div",{className:"container mx-auto px-4 md:px-6 lg:px-12 relative z-10",children:P.jsxs("div",{className:"grid lg:grid-cols-2 gap-6 md:gap-12 items-center",children:[P.jsxs("div",{className:"relative max-w-[280px] sm:max-w-sm mx-auto lg:max-w-none lg:order-2",children:[P.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-500/50 via-purple-600/40 to-purple-700/30 rounded-full lg:rounded-3xl blur-3xl opacity-60 animate-pulse"}),P.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-400/40 to-purple-600/30 rounded-full lg:rounded-3xl blur-2xl opacity-50"}),P.jsx("div",{className:"relative border-4 border-purple-500/40 shadow-2xl rounded-full lg:rounded-3xl overflow-hidden aspect-square lg:aspect-auto",style:{boxShadow:"0 0 50px rgba(168, 85, 247, 0.5), 0 0 100px rgba(168, 85, 247, 0.3), 0 0 150px rgba(168, 85, 247, 0.15), inset 0 0 20px rgba(168, 85, 247, 0.2)"},children:P.jsx("img",{src:(null==U?void 0:U.hero_image)||"/Estherreign.jpg",alt:"Esther Reign",className:"w-full h-full object-cover",style:{filter:"drop-shadow(0 0 40px rgba(168, 85, 247, 0.6)) drop-shadow(0 0 80px rgba(168, 85, 247, 0.4))"},loading:"eager"})})]}),P.jsxs("div",{className:"space-y-4 md:space-y-6 text-center lg:text-left lg:order-1",children:[P.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 md:px-4 md:py-2 bg-purple-500/20 rounded-full mx-auto lg:mx-0 border border-purple-500/30",children:[P.jsx(p,{size:14,className:"text-purple-300 animate-pulse"}),P.jsx("span",{className:"text-xs md:text-sm text-purple-200 font-medium",children:"Gospel Singer  Worship Leader"})]}),P.jsxs("h1",{className:"text-4xl sm:text-5xl md:text-6xl lg:text-7xl xl:text-8xl font-black leading-tight",children:[P.jsx("span",{className:"text-white",children:"Esther"}),P.jsx("br",{}),P.jsx("span",{className:"bg-gradient-to-r from-purple-400 to-purple-600 bg-clip-text text-transparent",children:"Reign"})]}),P.jsx("p",{className:"text-sm md:text-base lg:text-lg xl:text-xl text-gray-200 leading-relaxed max-w-xl mx-auto lg:mx-0",children:(null==U?void 0:U.hero_description)||"Lifting voices in worship through powerful gospel music. Experience the presence of God through every note."}),P.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 md:gap-4 justify-center lg:justify-start",children:[P.jsxs("button",{onClick:()=>J("videos"),className:"group bg-gradient-to-r from-purple-600 to-purple-700 px-6 py-3 md:px-8 md:py-4 rounded-full font-semibold flex items-center justify-center gap-2 text-white hover:shadow-lg hover:shadow-purple-500/50 transition-all text-sm md:text-base",children:["Watch Videos",P.jsx(f,{size:18,className:"group-hover:translate-x-1 transition-transform"})]}),P.jsx("button",{onClick:()=>J("contact"),className:"px-6 py-3 md:px-8 md:py-4 rounded-full font-semibold border-2 border-purple-500/30 text-purple-300 hover:border-purple-500/50 hover:bg-purple-500/10 transition-all text-sm md:text-base",children:"Get In Touch"})]}),P.jsxs("div",{className:"flex gap-3 md:gap-4 pt-4 md:pt-6 pb-6 md:pb-8 lg:pb-0 justify-center lg:justify-start",children:[P.jsx("a",{href:(null==(t=null==U?void 0:U.social_links)?void 0:t.instagram)||"https://instagram.com/estherreign",target:"_blank",rel:"noopener noreferrer",className:"w-10 h-10 md:w-12 md:h-12 bg-purple-500/20 border border-purple-500/30 hover:border-purple-500/50 hover:bg-purple-500/30 rounded-full flex items-center justify-center text-purple-300 transition-all",children:P.jsx(m,{size:18,className:"md:w-5 md:h-5"})}),P.jsx("a",{href:(null==(s=null==U?void 0:U.social_links)?void 0:s.youtube)||"https://youtube.com/@estherreign",target:"_blank",rel:"noopener noreferrer",className:"w-10 h-10 md:w-12 md:h-12 bg-purple-500/20 border border-purple-500/30 hover:border-purple-500/50 hover:bg-purple-500/30 rounded-full flex items-center justify-center text-purple-300 transition-all",children:P.jsx(g,{size:18,className:"md:w-5 md:h-5"})}),P.jsx("a",{href:(null==(r=null==U?void 0:U.social_links)?void 0:r.tiktok)||"https://tiktok.com/@estherreign",target:"_blank",rel:"noopener noreferrer",className:"w-10 h-10 md:w-12 md:h-12 bg-purple-500/20 border border-purple-500/30 hover:border-purple-500/50 hover:bg-purple-500/30 rounded-full flex items-center justify-center text-purple-300 transition-all",children:P.jsx($,{size:18,className:"md:w-5 md:h-5"})}),P.jsx("a",{href:(null==(n=null==U?void 0:U.social_links)?void 0:n.facebook)||"https://facebook.com/estherreign",target:"_blank",rel:"noopener noreferrer",className:"w-10 h-10 md:w-12 md:h-12 bg-purple-500/20 border border-purple-500/30 hover:border-purple-500/50 hover:bg-purple-500/30 rounded-full flex items-center justify-center text-purple-300 transition-all",children:P.jsx(I,{size:18,className:"md:w-5 md:h-5"})})]})]})]})})}),P.jsx("section",{id:"about",className:"py-16 md:py-24 lg:py-32 relative overflow-hidden bg-black",children:P.jsx("div",{className:"container mx-auto px-4 md:px-6 lg:px-12 relative z-10",children:P.jsxs("div",{className:"max-w-6xl mx-auto",children:[P.jsx("div",{className:"text-center mb-12 md:mb-20",children:P.jsx("h2",{className:"text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-black mb-6",children:P.jsx("span",{className:"bg-gradient-to-r from-white to-purple-400 bg-clip-text text-transparent",children:"About Me"})})}),P.jsxs("div",{className:"grid lg:grid-cols-2 gap-8 md:gap-12 lg:gap-16 items-center",children:[P.jsxs("div",{className:"relative",children:[P.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-500/30 to-purple-600/30 rounded-3xl blur-2xl opacity-30"}),P.jsx("div",{className:"relative border-4 border-white/20 shadow-2xl rounded-3xl overflow-hidden",children:P.jsx("img",{src:(null==U?void 0:U.about_image)||"/IMG-20250915-WA0023.jpg",alt:"About Esther",className:"w-full h-auto",loading:"lazy"})})]}),P.jsx("div",{className:"space-y-4 md:space-y-6",children:((null==U?void 0:U.about_text)||"I am an emerging gospel artist with a deep passion for worship and praise. Through powerful cover songs, I aim to create an atmosphere where people can encounter God's presence.\n\nEvery song I sing is a testimony of God's faithfulness and love. My mission is to use my voice as an instrument of worship, touching hearts and transforming lives through gospel music.\n\nJoin me on this journey as I share my gift with the world, one song at a time, bringing glory to God through music.").split("\n\n").map((e,t)=>P.jsx("p",{className:"text-base md:text-lg text-gray-200 leading-relaxed",children:e},t))})]})]})})}),P.jsx("section",{id:"videos",className:"py-16 md:py-24 lg:py-32 relative overflow-hidden bg-black",children:P.jsxs("div",{className:"container mx-auto px-4 md:px-6 lg:px-12 relative z-10",children:[P.jsxs("div",{className:"text-center mb-12 md:mb-20",children:[P.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-purple-500/20 border border-purple-500/30 rounded-full mb-6",children:[P.jsx(v,{size:16,className:"text-purple-300 animate-pulse"}),P.jsx("span",{className:"text-sm text-purple-200 font-medium",children:"Watch"})]}),P.jsx("h2",{className:"text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-black mb-4 md:mb-6",children:P.jsx("span",{className:"bg-gradient-to-r from-white to-purple-400 bg-clip-text text-transparent",children:"Videos"})}),P.jsx("p",{className:"text-gray-200 max-w-2xl mx-auto text-base md:text-lg px-4",children:"Experience powerful gospel worship that will uplift your spirit"})]}),0===C.length?P.jsxs("div",{className:"text-center py-20",children:[P.jsx("div",{className:"w-24 h-24 bg-purple-500/20 rounded-full flex items-center justify-center mx-auto mb-6",children:P.jsx(v,{size:48,className:"text-purple-300"})}),P.jsx("p",{className:"text-gray-300 text-xl",children:"New videos coming soon..."})]}):P.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6 lg:gap-8 max-w-7xl mx-auto",children:C.map((e,t)=>P.jsxs("div",{className:"group relative overflow-hidden rounded-2xl bg-purple-500/10 backdrop-blur-xl border border-purple-500/20 hover:border-purple-500/40 transition-all",children:[P.jsxs("div",{className:"aspect-video bg-gradient-to-br from-purple-900/50 to-purple-800/50 flex items-center justify-center relative overflow-hidden cursor-pointer",onClick:()=>z(e),onMouseEnter:t=>{const s=t.currentTarget.querySelector("video");s&&e.video_link&&!e.video_link.includes("youtube.com")&&!e.video_link.includes("youtu.be")&&(s.currentTime=0,s.play().catch(()=>{}))},onMouseLeave:e=>{const t=e.currentTarget.querySelector("video");t&&(t.pause(),t.currentTime=0)},children:[P.jsx("img",{src:e.thumbnail_url||H(e.video_link||""),alt:e.title,className:"absolute inset-0 w-full h-full object-cover",loading:"lazy",onError:t=>{t.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="640" height="360"%3E%3Crect fill="%23374151" width="640" height="360"/%3E%3Ctext fill="%239CA3AF" font-family="Arial" font-size="24" x="50%25" y="50%25" text-anchor="middle" dominant-baseline="middle"%3E'+encodeURIComponent(e.title)+"%3C/text%3E%3C/svg%3E"}}),e.video_link&&!e.video_link.includes("youtube.com")&&!e.video_link.includes("youtu.be")&&P.jsx("video",{src:e.video_link,className:"absolute inset-0 w-full h-full object-cover opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none z-20",muted:!0,loop:!0,playsInline:!0,preload:"metadata"}),P.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 via-transparent to-transparent flex items-center justify-center transition-all duration-300 group-hover:bg-black/30",children:P.jsx("button",{onClick:t=>{t.stopPropagation(),z(e)},className:"w-20 h-20 bg-purple-600/80 hover:bg-purple-600 rounded-full flex items-center justify-center transform transition-all shadow-lg group-hover:scale-125",children:P.jsx(v,{size:32,className:"text-white ml-1",fill:"currentColor"})})})]}),P.jsxs("div",{className:"p-6 bg-purple-500/5",children:[P.jsx("h3",{className:"text-lg font-bold mb-2 line-clamp-2 text-white",children:e.title}),e.template_type&&P.jsx("p",{className:"text-sm text-purple-300",children:e.template_type})]})]},e.id))})]})}),P.jsx("section",{id:"contact",className:"py-16 md:py-24 lg:py-32 relative overflow-hidden bg-black",children:P.jsx("div",{className:"container mx-auto px-4 md:px-6 lg:px-12 relative z-10",children:P.jsxs("div",{className:"max-w-4xl mx-auto",children:[P.jsxs("div",{className:"text-center mb-12 md:mb-20",children:[P.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-purple-500/20 border border-purple-500/30 rounded-full mb-6",children:[P.jsx(b,{size:16,className:"text-purple-300 animate-pulse"}),P.jsx("span",{className:"text-sm text-purple-200 font-medium",children:"Contact"})]}),P.jsx("h2",{className:"text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-black mb-4 md:mb-6",children:P.jsx("span",{className:"bg-gradient-to-r from-white to-purple-400 bg-clip-text text-transparent",children:"Let's Connect"})}),P.jsx("p",{className:"text-gray-200 max-w-2xl mx-auto text-base md:text-lg px-4",children:"For bookings, collaborations, or inquiries"})]}),P.jsx("div",{className:"mb-12 md:mb-16",children:P.jsx(xr,{})}),P.jsxs("div",{className:"flex justify-center gap-6",children:[P.jsx("a",{href:(null==(i=null==U?void 0:U.social_links)?void 0:i.instagram)||"https://instagram.com/estherreign",target:"_blank",rel:"noopener noreferrer",className:"w-14 h-14 bg-purple-500/20 border border-purple-500/30 hover:border-purple-500/50 hover:bg-purple-500/30 rounded-full flex items-center justify-center text-purple-300 transition-all",children:P.jsx(m,{size:24})}),P.jsx("a",{href:(null==(o=null==U?void 0:U.social_links)?void 0:o.youtube)||"https://youtube.com/@estherreign",target:"_blank",rel:"noopener noreferrer",className:"w-14 h-14 bg-purple-500/20 border border-purple-500/30 hover:border-purple-500/50 hover:bg-purple-500/30 rounded-full flex items-center justify-center text-purple-300 transition-all",children:P.jsx(g,{size:24})}),P.jsx("a",{href:(null==(a=null==U?void 0:U.social_links)?void 0:a.tiktok)||"https://tiktok.com/@estherreign",target:"_blank",rel:"noopener noreferrer",className:"w-14 h-14 bg-purple-500/20 border border-purple-500/30 hover:border-purple-500/50 hover:bg-purple-500/30 rounded-full flex items-center justify-center text-purple-300 transition-all",children:P.jsx($,{size:24})}),P.jsx("a",{href:(null==(l=null==U?void 0:U.social_links)?void 0:l.facebook)||"https://facebook.com/estherreign",target:"_blank",rel:"noopener noreferrer",className:"w-14 h-14 bg-purple-500/20 border border-purple-500/30 hover:border-purple-500/50 hover:bg-purple-500/30 rounded-full flex items-center justify-center text-purple-300 transition-all",children:P.jsx(I,{size:24})})]})]})})}),P.jsx("footer",{className:"py-8 border-t border-purple-500/30 bg-black/80",children:P.jsx("div",{className:"container mx-auto px-6 lg:px-12",children:P.jsx("div",{className:"text-center",children:P.jsx("p",{className:"text-gray-300 text-sm font-medium",children:" 2025 Esther Reign. All rights reserved."})})})}),B&&P.jsxs("div",{className:"fixed inset-0 bg-black/95 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:[P.jsx("button",{onClick:()=>z(null),className:"absolute top-6 right-6 w-12 h-12 bg-purple-500/20 hover:bg-purple-500/30 rounded-full flex items-center justify-center transition-colors z-10",children:P.jsx(d,{size:24,className:"text-white"})}),P.jsxs("div",{className:"w-full max-w-5xl",children:[P.jsxs("div",{className:"mb-4",children:[P.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white mb-2",children:B.title}),B.template_type&&P.jsx("p",{className:"text-purple-300 text-sm",children:B.template_type})]}),P.jsx("div",{className:"relative aspect-video bg-black rounded-xl overflow-hidden shadow-2xl",children:(null==(c=B.video_link)?void 0:c.includes("youtube.com"))||(null==(h=B.video_link)?void 0:h.includes("youtu.be"))?P.jsx("iframe",{src:`https://www.youtube.com/embed/${(null==(y=B.video_link.match(/[?&]v=([^&]+)/))?void 0:y[1])||(null==(w=B.video_link.match(/youtu\.be\/([^?]+)/))?void 0:w[1])}`,className:"w-full h-full",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,title:B.title}):P.jsx("video",{src:B.video_link,controls:!0,autoPlay:!0,className:"w-full h-full",controlsList:"nodownload",children:"Your browser does not support the video tag."})}),P.jsx("div",{className:"mt-4 flex justify-center gap-4",children:P.jsxs("a",{href:B.video_link,target:"_blank",rel:"noopener noreferrer",className:"bg-gradient-to-r from-purple-600 to-purple-700 px-6 py-3 rounded-full text-white font-medium flex items-center gap-2 hover:shadow-lg hover:shadow-purple-500/50 transition-all",children:["Open in New Tab",P.jsx(f,{size:18})]})})]})]})]})};let Sr=null,Tr=!1;async function Er(){if(!("serviceWorker"in navigator))return null;try{const e=await navigator.serviceWorker.register("/sw.js",{scope:"/"});return setInterval(()=>{e.update()},36e5),e.addEventListener("updatefound",()=>{const t=e.installing;t&&t.addEventListener("statechange",()=>{"installed"===t.state&&navigator.serviceWorker.controller&&function(){var e,t;const s=document.createElement("div");s.id="pwa-update-banner",s.innerHTML='\n    <div style="\n      position: fixed;\n      bottom: 20px;\n      left: 50%;\n      transform: translateX(-50%);\n      background: linear-gradient(135deg, #d4af37 0%, #fbbf24 100%);\n      color: white;\n      padding: 16px 24px;\n      border-radius: 12px;\n      box-shadow: 0 4px 12px rgba(0,0,0,0.3);\n      z-index: 10000;\n      display: flex;\n      align-items: center;\n      gap: 16px;\n      max-width: 90%;\n      animation: slideUp 0.3s ease-out;\n    ">\n      <span style="flex: 1; font-size: 14px; font-weight: 500;">\n         New version available!\n      </span>\n      <button id="pwa-update-btn" style="\n        background: white;\n        color: #0a0a0a;\n        border: none;\n        padding: 8px 16px;\n        border-radius: 6px;\n        font-weight: 600;\n        cursor: pointer;\n        font-size: 14px;\n      ">\n        Update Now\n      </button>\n      <button id="pwa-dismiss-btn" style="\n        background: transparent;\n        color: white;\n        border: 1px solid rgba(255,255,255,0.3);\n        padding: 8px 16px;\n        border-radius: 6px;\n        font-weight: 600;\n        cursor: pointer;\n        font-size: 14px;\n      ">\n        Later\n      </button>\n    </div>\n    <style>\n      @keyframes slideUp {\n        from {\n          transform: translateX(-50%) translateY(100px);\n          opacity: 0;\n        }\n        to {\n          transform: translateX(-50%) translateY(0);\n          opacity: 1;\n        }\n      }\n    </style>\n  ',document.body.appendChild(s),null==(e=document.getElementById("pwa-update-btn"))||e.addEventListener("click",()=>{navigator.serviceWorker.controller&&(navigator.serviceWorker.controller.postMessage({type:"SKIP_WAITING"}),window.location.reload())}),null==(t=document.getElementById("pwa-dismiss-btn"))||t.addEventListener("click",()=>{s.remove()})}()})}),e}catch(e){return null}}function Or(){window.matchMedia("(display-mode: standalone)").matches||!0===window.navigator.standalone?Tr=!0:(window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),Sr=e,setTimeout(()=>{!function(){if(document.getElementById("pwa-install-btn"))return;const e=document.createElement("style");e.textContent="\n    @keyframes pwa-pulse {\n      0%, 100% {\n        transform: scale(1);\n        box-shadow: 0 4px 12px rgba(212, 175, 55, 0.4);\n      }\n      50% {\n        transform: scale(1.05);\n        box-shadow: 0 6px 16px rgba(212, 175, 55, 0.6);\n      }\n    }\n    \n    #pwa-install-btn {\n      position: fixed;\n      top: 80px;\n      left: 20px;\n      background: linear-gradient(135deg, #d4af37 0%, #fbbf24 100%);\n      color: white;\n      padding: 10px 16px;\n      border-radius: 50px;\n      box-shadow: 0 4px 12px rgba(212, 175, 55, 0.4);\n      z-index: 9998;\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      cursor: pointer;\n      border: none;\n      font-weight: 600;\n      font-size: 13px;\n      animation: pwa-pulse 2s ease-in-out infinite;\n      transition: all 0.3s ease;\n    }\n    \n    #pwa-install-btn:hover {\n      transform: scale(1.05);\n      box-shadow: 0 6px 20px rgba(212, 175, 55, 0.6);\n    }\n    \n    #pwa-install-btn:active {\n      transform: scale(0.95);\n    }\n    \n    @media (max-width: 768px) {\n      #pwa-install-btn {\n        top: 70px;\n        left: 10px;\n        padding: 8px 12px;\n        font-size: 12px;\n        gap: 6px;\n      }\n      \n      #pwa-install-btn span:last-child {\n        display: none;\n      }\n    }\n  ",document.head.appendChild(e);const t=document.createElement("button");t.id="pwa-install-btn",t.innerHTML='\n    <span style="font-size: 20px;"></span>\n    <span>Install App</span>\n  ',t.addEventListener("click",Cr),document.body.appendChild(t)}()},1e3)}),window.addEventListener("appinstalled",()=>{Tr=!0,Sr=null,Pr(),function(){const e=document.createElement("div");e.innerHTML='\n    <div style="\n      position: fixed;\n      top: 20px;\n      left: 50%;\n      transform: translateX(-50%);\n      background: linear-gradient(135deg, #10b981 0%, #059669 100%);\n      color: white;\n      padding: 16px 24px;\n      border-radius: 12px;\n      box-shadow: 0 4px 12px rgba(0,0,0,0.3);\n      z-index: 10000;\n      animation: slideDown 0.3s ease-out;\n      font-weight: 500;\n    ">\n       App installed successfully!\n    </div>\n    <style>\n      @keyframes slideDown {\n        from {\n          transform: translateX(-50%) translateY(-100px);\n          opacity: 0;\n        }\n        to {\n          transform: translateX(-50%) translateY(0);\n          opacity: 1;\n        }\n      }\n    </style>\n  ',document.body.appendChild(e),setTimeout(()=>{e.style.animation="slideDown 0.3s ease-out reverse",setTimeout(()=>e.remove(),300)},3e3)}()}),setTimeout(()=>{},5e3))}function Pr(){const e=document.getElementById("pwa-install-btn");e&&(e.style.animation="fadeOut 0.3s ease-out",setTimeout(()=>e.remove(),300))}async function Cr(){if(!Sr)return Nr(),!1;try{await Sr.prompt();const{outcome:e}=await Sr.userChoice;return"accepted"===e&&(Pr(),!0)}catch(e){return Nr(),!1}}function Nr(){var e,t;const s=/iPad|iPhone|iPod/.test(navigator.userAgent),r=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);let n="";n=s&&r?'\n      <div style="text-align: left; line-height: 1.6;">\n        <p style="margin-bottom: 12px; font-weight: 600;">To install on iOS:</p>\n        <ol style="padding-left: 20px; margin: 0;">\n          <li style="margin-bottom: 8px;">Tap the Share button <span style="font-size: 20px;"></span></li>\n          <li style="margin-bottom: 8px;">Scroll down and tap "Add to Home Screen"</li>\n          <li style="margin-bottom: 8px;">Tap "Add" in the top right</li>\n        </ol>\n      </div>\n    ':'\n      <div style="text-align: left; line-height: 1.6;">\n        <p style="margin-bottom: 12px; font-weight: 600;">To install:</p>\n        <ol style="padding-left: 20px; margin: 0;">\n          <li style="margin-bottom: 8px;">Open this site in Chrome or Edge</li>\n          <li style="margin-bottom: 8px;">Look for the install icon in the address bar</li>\n          <li style="margin-bottom: 8px;">Click "Install" when prompted</li>\n        </ol>\n      </div>\n    ';const i=document.createElement("div");i.innerHTML=`\n    <div style="\n      position: fixed;\n      inset: 0;\n      background: rgba(0,0,0,0.7);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      z-index: 10001;\n      padding: 20px;\n      animation: fadeIn 0.2s ease-out;\n    " id="install-modal">\n      <div style="\n        background: white;\n        border-radius: 16px;\n        padding: 24px;\n        max-width: 400px;\n        width: 100%;\n        box-shadow: 0 8px 32px rgba(0,0,0,0.3);\n      ">\n        <h3 style="margin: 0 0 16px 0; font-size: 20px; color: #333;">\n          Install Esther Reign Admin\n        </h3>\n        ${n}\n        <button id="close-install-modal" style="\n          margin-top: 20px;\n          width: 100%;\n          padding: 12px;\n          background: linear-gradient(135deg, #d4af37 0%, #fbbf24 100%);\n          color: white;\n          border: none;\n          border-radius: 8px;\n          font-weight: 600;\n          cursor: pointer;\n          font-size: 14px;\n        ">\n          Got it!\n        </button>\n      </div>\n    </div>\n    <style>\n      @keyframes fadeIn {\n        from { opacity: 0; }\n        to { opacity: 1; }\n      }\n    </style>\n  `,document.body.appendChild(i),null==(e=document.getElementById("close-install-modal"))||e.addEventListener("click",()=>{i.remove()}),null==(t=document.getElementById("install-modal"))||t.addEventListener("click",e=>{e.target===document.getElementById("install-modal")&&i.remove()})}const Ar=e.createContext(void 0),Ir=({children:t})=>{const[s,r]=e.useState(()=>localStorage.getItem("theme")||"gaming");e.useEffect(()=>{localStorage.setItem("theme",s),document.documentElement.classList.remove("light","dark","gaming"),document.documentElement.classList.add(s)},[s]);return P.jsx(Ar.Provider,{value:{theme:s,toggleTheme:()=>{r(e=>"light"===e?"dark":"dark"===e?"gaming":"light")},setTheme:r},children:t})},$r=()=>{const t=e.useContext(Ar);if(!t)throw new Error("useTheme must be used within ThemeProvider");return t};(async function(){await Er(),Or(),Tr||window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone})().then(()=>{}).catch(e=>{}),O(document.getElementById("root")).render(P.jsx(e.StrictMode,{children:P.jsx(Ir,{children:P.jsx(jr,{})})}));export{L as P,A as _,$r as a,P as j,wr as s,_r as u};
